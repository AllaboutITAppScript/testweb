<!DOCTYPE html>
<html lang="th" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Code Tester Pro - Multi-language Code Editor</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- CodeMirror -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/theme/dracula.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/clike/clike.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/php/php.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/edit/matchbrackets.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .resizer {
            position: absolute;
            top: 0;
            right: -5px;
            width: 10px;
            height: 100%;
            cursor: col-resize;
            z-index: 50;
        }
        
        .resizer:hover {
            background-color: rgba(59, 130, 246, 0.3);
        }
        
        .resizer.active {
            background-color: rgba(59, 130, 246, 0.5);
        }
        
        .preview-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
            border-radius: 0.5rem;
        }
        
        .dark .preview-frame {
            background: #1e293b;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .live-indicator {
            animation: pulse 2s infinite;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #374151;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #6b7280;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }
        
        /* Split view layout */
        .split-container {
            display: flex;
            height: calc(100vh - 120px);
            position: relative;
            overflow: hidden;
        }
        
        .editor-section {
            width: 50%;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .preview-section {
            width: 50%;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* Editor with line numbers */
        .editor-wrapper {
            position: relative;
            flex: 1;
            overflow: hidden;
        }
        
        /* Fullscreen mode */
        .fullscreen {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 1000 !important;
            margin: 0 !important;
            border-radius: 0 !important;
            border: none !important;
        }
        
        /* Beautiful Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: -400px;
            z-index: 1000;
            transition: right 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            max-width: 350px;
        }
        
        .notification.show {
            right: 20px;
        }
        
        .notification-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .notification-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: rgba(255, 255, 255, 0.3);
        }
        
        .notification-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .notification-error {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        .notification-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .notification-info {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        }
        
        /* Modal for download */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background-color: #1f2937;
            border-radius: 15px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            transform: translateY(0);
            animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Language selector */
        .language-selector {
            position: relative;
            z-index: 10;
        }
        
        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: #1f2937;
            border: 1px solid #374151;
            border-radius: 0.5rem;
            padding: 0.5rem 0;
            min-width: 180px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 100;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .language-dropdown.show {
            display: block;
            animation: fadeInDown 0.3s ease;
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .language-option {
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            border-left: 3px solid transparent;
        }
        
        .language-option:hover {
            background-color: #374151;
            border-left-color: #3b82f6;
        }
        
        .language-option.active {
            background-color: rgba(59, 130, 246, 0.2);
            border-left-color: #3b82f6;
        }
        
        /* Preview mode buttons */
        .preview-modes {
            display: flex;
            gap: 0.5rem;
            margin-right: 1rem;
        }
        
        .preview-mode-btn {
            padding: 0.5rem 1rem;
            background-color: #374151;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .preview-mode-btn:hover {
            background-color: #4b5563;
            transform: translateY(-2px);
        }
        
        .preview-mode-btn.active {
            background-color: #3b82f6;
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        /* Console output */
        .console-output {
            background-color: #0f172a;
            color: #e2e8f0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            padding: 1rem;
            overflow: auto;
            height: 100%;
            border-radius: 0.375rem;
        }
        
        .console-line {
            margin-bottom: 0.25rem;
            white-space: pre-wrap;
        }
        
        .console-command {
            color: #10b981;
        }
        
        .console-output-text {
            color: #e2e8f0;
        }
        
        .console-error {
            color: #ef4444;
        }
        
        .console-warning {
            color: #f59e0b;
        }
        
        .console-info {
            color: #3b82f6;
        }
        
        .console-success {
            color: #10b981;
        }
        
        /* Run code button animation */
        @keyframes runButtonPulse {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
        
        .run-button-animation {
            animation: runButtonPulse 1.5s infinite;
        }
        
        /* Code execution result panel */
        .execution-result {
            background-color: #1e293b;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            border-left: 4px solid #3b82f6;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .execution-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #374151;
        }
        
        .execution-time {
            color: #94a3b8;
            font-size: 0.875rem;
        }
        
        /* Tab system for output */
        .output-tabs {
            display: flex;
            border-bottom: 1px solid #374151;
            margin-bottom: 1rem;
        }
        
        .output-tab {
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }
        
        .output-tab:hover {
            background-color: #374151;
        }
        
        .output-tab.active {
            border-bottom-color: #3b82f6;
            color: #3b82f6;
            font-weight: 600;
        }
        
        .output-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .output-content.active {
            display: block;
        }
        
        /* Floating action button */
        .floating-action-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s;
            border: none;
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 30px rgba(59, 130, 246, 0.4);
        }
        
        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #3b82f6;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Code execution area */
        .code-execution {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .execution-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #1e293b;
            border-bottom: 1px solid #374151;
        }
        
        .execution-content {
            flex: 1;
            overflow: auto;
            padding: 15px;
            background: white;
            color: black;
        }
        
        .dark .execution-content {
            background: #0f172a;
            color: white;
        }
        
        /* Output styling */
        .output-area {
            white-space: pre-wrap;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* Iframe for web output */
        .web-output {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        /* Run output styles */
        .run-output {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            margin-top: 10px;
            border-left: 4px solid #3b82f6;
        }
        
        .dark .run-output {
            background: #1e293b;
        }
        
        /* CodeMirror customization */
        .CodeMirror {
            height: 100% !important;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace !important;
            font-size: 14px !important;
        }
        
        .cm-s-dracula.CodeMirror {
            background-color: #1e293b !important;
            color: #f8f8f2 !important;
        }
        
        .cm-s-dracula .CodeMirror-gutters {
            background-color: #1e293b !important;
            border-right: 1px solid #374151 !important;
        }
        
        .cm-s-dracula .CodeMirror-linenumber {
            color: #9ca3af !important;
        }
        
        /* PHP specific styles */
        .php-output {
            background: #4F5B93;
            color: white;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
        }
        
        /* JavaScript output styles */
        .js-output {
            background: #f7df1e;
            color: #000;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
        }
        
        /* Code examples styling */
        .example-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .example-item {
            padding: 10px;
            border-bottom: 1px solid #374151;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .example-item:hover {
            background: #374151;
        }
        
        /* Error message styling */
        .error-message {
            background: #fee;
            color: #c33;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #c33;
            margin: 10px 0;
        }
        
        /* Success message */
        .success-message {
            background: #dfd;
            color: #383;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #383;
            margin: 10px 0;
        }
    </style>
</head>
<body class="dark:bg-gray-900 dark:text-gray-200 bg-gray-100 text-gray-800 transition-colors duration-300">
    <!-- Notification -->
    <div id="notification" class="notification">
        <div class="notification-content" id="notification-content">
            <div class="flex items-center">
                <i class="fas fa-check-circle text-xl mr-3"></i>
                <div>
                    <h4 class="font-bold" id="notification-title">ดำเนินการสำเร็จ</h4>
                    <p class="text-sm opacity-90" id="notification-text">ระบบได้บันทึกโค้ดของคุณแล้ว</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Download Modal -->
    <div id="download-modal" class="modal">
        <div class="modal-content">
            <h3 class="text-xl font-bold mb-4 flex items-center">
                <i class="fas fa-download mr-2 text-blue-500"></i> ดาวน์โหลดไฟล์โค้ด
            </h3>
            <div class="mb-6">
                <label for="filename" class="block mb-2 font-medium">ชื่อไฟล์:</label>
                <input type="text" id="filename" class="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" value="my-code.html">
                <p class="text-sm text-gray-400 mt-2" id="file-extension">ไฟล์จะถูกดาวน์โหลดเป็นไฟล์ .html</p>
            </div>
            <div class="flex justify-end space-x-3">
                <button id="cancel-download" class="px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors">ยกเลิก</button>
                <button id="confirm-download" class="px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors flex items-center">
                    <i class="fas fa-download mr-2"></i> ดาวน์โหลด
                </button>
            </div>
        </div>
    </div>
    
    <!-- Floating Action Button -->
    <button id="quick-run-btn" class="floating-action-btn" title="รันโค้ด (Ctrl+Enter)">
        <i class="fas fa-play"></i>
    </button>
    
    <div class="container mx-auto px-4 py-2 h-screen flex flex-col">
        <!-- Header -->
        <header class="flex flex-col md:flex-row justify-between items-center mb-4 py-3">
            <div class="flex items-center space-x-3 mb-3 md:mb-0">
                <div class="bg-gradient-to-br from-blue-600 to-purple-600 p-2 rounded-lg shadow-lg">
                    <i class="fas fa-code text-white text-xl"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold bg-gradient-to-r from-blue-500 to-purple-500 bg-clip-text text-transparent">Live Code Tester Pro</h1>
                    <p class="text-sm text-gray-500 dark:text-gray-400">ทดสอบโค้ดหลายภาษาแบบเรียลไทม์</p>
                </div>
            </div>
            
            <!-- Controls -->
            <div class="flex flex-wrap gap-3 items-center">
                <div class="flex items-center space-x-2">
                    <span class="text-sm hidden md:block">ภาษา:</span>
                    <div class="language-selector">
                        <button id="language-selector-btn" class="bg-gray-800 dark:bg-gray-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-gray-700 dark:hover:bg-gray-600 transition-colors shadow-md">
                            <i class="fab fa-html5 text-orange-500"></i>
                            <span id="current-language">HTML</span>
                            <i class="fas fa-chevron-down ml-1"></i>
                        </button>
                        <div id="language-dropdown" class="language-dropdown">
                            <div class="language-option active" data-lang="html">
                                <i class="fab fa-html5 mr-2 text-orange-500"></i>
                                <div>
                                    <div class="font-medium">HTML</div>
                                    <div class="text-xs text-gray-400">สำหรับเว็บเพจ</div>
                                </div>
                            </div>
                            <div class="language-option" data-lang="javascript">
                                <i class="fab fa-js mr-2 text-yellow-500"></i>
                                <div>
                                    <div class="font-medium">JavaScript</div>
                                    <div class="text-xs text-gray-400">ภาษาสคริปต์</div>
                                </div>
                            </div>
                            <div class="language-option" data-lang="python">
                                <i class="fab fa-python mr-2 text-yellow-500"></i>
                                <div>
                                    <div class="font-medium">Python</div>
                                    <div class="text-xs text-gray-400">ภาษาสคริปต์</div>
                                </div>
                            </div>
                            <div class="language-option" data-lang="php">
                                <i class="fab fa-php mr-2 text-indigo-500"></i>
                                <div>
                                    <div class="font-medium">PHP</div>
                                    <div class="text-xs text-gray-400">เว็บเซิร์ฟเวอร์</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex items-center space-x-2">
                    <span class="text-sm hidden md:block">ธีม:</span>
                    <button id="theme-toggle" class="bg-gray-800 dark:bg-gray-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-gray-700 dark:hover:bg-gray-600 transition-colors shadow-md">
                        <i class="fas fa-moon"></i>
                        <span id="theme-text">ดาร์ก</span>
                    </button>
                </div>
                
                <div class="flex items-center space-x-2">
                    <div class="flex space-x-2">
                        <button id="run-btn" class="bg-gradient-to-r from-blue-500 to-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:from-blue-600 hover:to-blue-800 transition-all shadow-md run-button-animation">
                            <i class="fas fa-play-circle"></i>
                            <span>รันโค้ด</span>
                        </button>
                    </div>
                </div>
                
                <button id="download-btn" class="bg-gradient-to-r from-purple-500 to-purple-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:from-purple-600 hover:to-purple-800 transition-all shadow-md">
                    <i class="fas fa-download"></i>
                    <span>ดาวน์โหลด</span>
                </button>
                
                <button id="reset-btn" class="bg-gradient-to-r from-red-500 to-red-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:from-red-600 hover:to-red-800 transition-all shadow-md">
                    <i class="fas fa-trash-alt"></i>
                    <span>รีเซ็ต</span>
                </button>
            </div>
        </header>
        
        <!-- Live Indicator -->
        <div class="flex items-center justify-center mb-2">
            <div id="live-indicator" class="flex items-center space-x-2 bg-gradient-to-r from-green-900 to-green-700 text-green-200 px-4 py-2 rounded-lg shadow">
                <i class="fas fa-circle live-indicator"></i>
                <span id="live-status-text">พร้อมใช้งาน</span>
            </div>
        </div>
        
        <!-- Split View Container -->
        <div class="split-container">
            <!-- Editor Panel -->
            <div class="editor-section bg-gray-900 dark:bg-gray-800 rounded-lg border border-gray-700 relative shadow-lg">
                <div class="flex justify-between items-center bg-gradient-to-r from-gray-800 to-gray-900 dark:from-gray-900 dark:to-gray-800 px-4 py-3 rounded-t-lg border-b border-gray-700">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-code text-green-400"></i>
                        <h2 class="font-bold" id="editor-title">HTML Editor</h2>
                        <span class="text-xs bg-blue-900 text-blue-200 px-2 py-1 rounded">CodeMirror</span>
                        <div class="example-selector">
                            <button id="example-btn" class="bg-gray-700 text-white px-3 py-1 rounded-lg hover:bg-gray-600 transition-colors flex items-center">
                                <i class="fas fa-code-branch mr-1"></i> ตัวอย่าง
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button id="fullscreen-btn" class="ml-2 bg-gray-700 text-white px-3 py-1.5 rounded-lg flex items-center space-x-2 hover:bg-gray-600 transition-colors">
                            <i class="fas fa-expand"></i>
                            <span class="hidden md:inline">เต็มจอ</span>
                        </button>
                    </div>
                </div>
                
                <div class="editor-wrapper">
                    <textarea id="code-editor" class="hidden"></textarea>
                </div>
                
                <!-- Resizer -->
                <div class="resizer"></div>
            </div>
            
            <!-- Preview Panel -->
            <div class="preview-section bg-gray-800 dark:bg-gray-700 rounded-lg border border-gray-700 shadow-lg">
                <div class="flex justify-between items-center bg-gradient-to-r from-gray-800 to-gray-900 dark:from-gray-900 dark:to-gray-800 px-4 py-3 rounded-t-lg border-b border-gray-700">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-eye text-blue-400"></i>
                        <h2 class="font-bold" id="preview-title">ผลลัพธ์</h2>
                    </div>
                    <div class="text-sm text-gray-400">
                        <i class="fas fa-clock mr-1"></i>
                        <span>อัปเดตล่าสุด: <span id="last-update">-</span></span>
                    </div>
                </div>
                
                <div class="flex-1 p-4 overflow-hidden">
                    <div id="execution-output" class="execution-content">
                        <div class="run-output">
                            <div id="run-result" class="output-area">
                                ระบบพร้อมใช้งาน โปรดเขียนโค้ดและคลิก "รันโค้ด"
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="mt-4 pt-3 border-t border-gray-700">
            <div class="flex flex-col md:flex-row justify-between items-center text-sm text-gray-500 dark:text-gray-400">
                <div class="mb-2 md:mb-0 text-center md:text-left">
                    <p class="flex items-center">
                        <i class="fas fa-code mr-1"></i> Live Code Tester Pro - รองรับ HTML, JavaScript, Python, PHP
                    </p>
                </div>
                <div class="flex flex-wrap justify-center gap-4">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-keyboard"></i>
                        <span>กด <kbd class="px-2 py-1 bg-gray-800 rounded shadow">Ctrl+S</kbd> เพื่อบันทึก</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-bolt"></i>
                        <span>กด <kbd class="px-2 py-1 bg-gray-800 rounded shadow">Ctrl+Enter</kbd> เพื่อรันโค้ด</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elements
            const codeEditorTextarea = document.getElementById('code-editor');
            const themeToggle = document.getElementById('theme-toggle');
            const themeText = document.getElementById('theme-text');
            const runBtn = document.getElementById('run-btn');
            const quickRunBtn = document.getElementById('quick-run-btn');
            const resetBtn = document.getElementById('reset-btn');
            const downloadBtn = document.getElementById('download-btn');
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            const lastUpdateEl = document.getElementById('last-update');
            const resizer = document.querySelector('.resizer');
            const editorSection = document.querySelector('.editor-section');
            const previewSection = document.querySelector('.preview-section');
            const notification = document.getElementById('notification');
            const notificationTitle = document.getElementById('notification-title');
            const notificationText = document.getElementById('notification-text');
            const notificationContent = document.getElementById('notification-content');
            const downloadModal = document.getElementById('download-modal');
            const filenameInput = document.getElementById('filename');
            const fileExtensionText = document.getElementById('file-extension');
            const confirmDownloadBtn = document.getElementById('confirm-download');
            const cancelDownloadBtn = document.getElementById('cancel-download');
            const languageSelectorBtn = document.getElementById('language-selector-btn');
            const languageDropdown = document.getElementById('language-dropdown');
            const currentLanguageEl = document.getElementById('current-language');
            const editorTitle = document.getElementById('editor-title');
            const previewTitle = document.getElementById('preview-title');
            const exampleBtn = document.getElementById('example-btn');
            const runResult = document.getElementById('run-result');
            const executionOutput = document.getElementById('execution-output');
            
            // State variables
            let isDarkMode = true;
            let isResizing = false;
            let isFullscreen = false;
            let editorWidth = 50;
            let currentLanguage = 'html';
            let isRunningCode = false;
            let codeMirrorEditor = null;
            
            // Code examples
            const codeExamples = {
                html: `<!DOCTYPE html>
<html>
<head>
    <title>ตัวอย่าง HTML</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        h1 { 
            color: #fff; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .box { 
            background: rgba(255,255,255,0.9); 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 10px;
            color: #333;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #2563eb;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #e8f4fd;
            border-radius: 5px;
            color: #1e40af;
        }
    </style>
</head>
<body>
    <h1>สวัสดี Live Code Tester Pro!</h1>
    <div class="box">
        <p>นี่คือตัวอย่างโค้ด HTML พื้นฐาน</p>
        <button onclick="showMessage()">คลิกทดสอบ</button>
        <div id="message" class="result"></div>
    </div>
    <script>
        function showMessage() {
            const now = new Date();
            const message = document.getElementById('message');
            message.innerHTML = \`
                <h3>ยินดีต้อนรับสู่ Live Code Tester!</h3>
                <p>คุณสามารถทดสอบโค้ดได้ทันทีที่นี่</p>
                <p>เวลาปัจจุบัน: \${now.toLocaleTimeString('th-TH')}</p>
                <p>วันที่: \${now.toLocaleDateString('th-TH')}</p>
            \`;
        }
        
        // โหลดหน้าเว็บแสดงข้อความทักทาย
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('message').innerHTML = 
                '<p>ระบบ HTML พร้อมใช้งาน! คลิกปุ่มเพื่อทดสอบ</p>';
        });
    <\/script>
</body>
</html>`,

                javascript: `// JavaScript Example - Simple Calculator
console.log("JavaScript Code Runner Started");

// DOM Elements
const output = document.getElementById('output');
const resultDiv = document.createElement('div');
resultDiv.className = 'result';
document.body.appendChild(resultDiv);

// Display initial message
resultDiv.innerHTML = \`
    <h2>JavaScript Code Runner</h2>
    <p>Welcome to JavaScript testing environment!</p>
    <div id="calc" style="background: #f0f0f0; padding: 15px; border-radius: 5px; margin: 10px 0;">
        <h3>Simple Calculator</h3>
        <input type="number" id="num1" placeholder="Number 1" value="10">
        <input type="number" id="num2" placeholder="Number 2" value="5">
        <br><br>
        <button onclick="calculate('add')">+ Add</button>
        <button onclick="calculate('subtract')">- Subtract</button>
        <button onclick="calculate('multiply')">× Multiply</button>
        <button onclick="calculate('divide')">÷ Divide</button>
        <p id="calcResult" style="font-weight: bold; margin-top: 10px;"></p>
    </div>
\`;

// Calculator functions
function calculate(operation) {
    const num1 = parseFloat(document.getElementById('num1').value) || 0;
    const num2 = parseFloat(document.getElementById('num2').value) || 0;
    let result;
    let symbol;
    
    switch(operation) {
        case 'add':
            result = num1 + num2;
            symbol = '+';
            break;
        case 'subtract':
            result = num1 - num2;
            symbol = '-';
            break;
        case 'multiply':
            result = num1 * num2;
            symbol = '×';
            break;
        case 'divide':
            result = num2 !== 0 ? num1 / num2 : 'Error: Division by zero';
            symbol = '÷';
            break;
        default:
            result = 'Invalid operation';
    }
    
    document.getElementById('calcResult').innerHTML = 
        \`\${num1} \${symbol} \${num2} = <span style="color: #3b82f6;">\${result}</span>\`;
}

// Array operations example
const fruits = ['Apple', 'Banana', 'Orange', 'Mango', 'Grape'];
console.log("Fruits array:", fruits);

// Object example
const student = {
    name: "John Doe",
    age: 20,
    grades: [85, 90, 78, 92],
    getAverage: function() {
        return this.grades.reduce((a, b) => a + b, 0) / this.grades.length;
    }
};

console.log("Student object:", student);
console.log("Average grade:", student.getAverage());

// Function example
function fibonacci(n) {
    let a = 0, b = 1;
    const result = [];
    for (let i = 0; i < n; i++) {
        result.push(a);
        [a, b] = [b, a + b];
    }
    return result;
}

console.log("First 10 Fibonacci numbers:", fibonacci(10));

// Display results on page
const infoDiv = document.createElement('div');
infoDiv.innerHTML = \`
    <div style="background: #e8f5e9; padding: 15px; border-radius: 5px; margin-top: 20px;">
        <h3>Console Output:</h3>
        <p>✓ JavaScript code executed successfully</p>
        <p>✓ Check browser console (F12) for detailed output</p>
        <p>✓ Student average grade: \${student.getAverage().toFixed(2)}</p>
        <p>✓ Fruits count: \${fruits.length}</p>
    </div>
\`;
document.body.appendChild(infoDiv);

console.log("JavaScript execution completed!");`,

                python: `# Python Example - Simple Programs

print("=" * 50)
print("PYTHON CODE RUNNER")
print("=" * 50)
print()

# 1. Basic Operations
print("1. BASIC OPERATIONS")
print("-" * 30)

a = 15
b = 7
print(f"a = {a}, b = {b}")
print(f"a + b = {a + b}")
print(f"a - b = {a - b}")
print(f"a * b = {a * b}")
print(f"a / b = {a / b:.2f}")
print(f"a // b = {a // b} (integer division)")
print(f"a % b = {a % b} (modulus)")
print(f"a ** 2 = {a ** 2} (square)")
print()

# 2. String Operations
print("2. STRING OPERATIONS")
print("-" * 30)

name = "Python Developer"
print(f"Original string: {name}")
print(f"Upper case: {name.upper()}")
print(f"Lower case: {name.lower()}")
print(f"Title case: {name.title()}")
print(f"Length: {len(name)} characters")
print(f"First 6 chars: {name[:6]}")
print(f"Last 9 chars: {name[-9:]}")
print(f"Contains 'Python': {'Python' in name}")
print()

# 3. List Operations
print("3. LIST OPERATIONS")
print("-" * 30)

fruits = ["Apple", "Banana", "Orange", "Mango", "Grape"]
print(f"Fruits list: {fruits}")
print(f"Number of fruits: {len(fruits)}")
print(f"First fruit: {fruits[0]}")
print(f"Last fruit: {fruits[-1]}")
print(f"Sliced (first 3): {fruits[:3]}")

# Add and remove items
fruits.append("Pineapple")
print(f"After adding Pineapple: {fruits}")

fruits.remove("Banana")
print(f"After removing Banana: {fruits}")

# List comprehension
squared_numbers = [x**2 for x in range(1, 6)]
print(f"Squares of 1-5: {squared_numbers}")
print()

# 4. Dictionary Operations
print("4. DICTIONARY OPERATIONS")
print("-" * 30)

student = {
    "name": "สมชาย",
    "age": 20,
    "grades": [85, 90, 78, 92],
    "major": "Computer Science"
}

print("Student Information:")
for key, value in student.items():
    print(f"  {key}: {value}")

# Calculate average grade
grades = student["grades"]
average = sum(grades) / len(grades)
print(f"Average grade: {average:.2f}")
print()

# 5. Function Examples
print("5. FUNCTION EXAMPLES")
print("-" * 30)

def factorial(n):
    """Calculate factorial of a number"""
    if n <= 1:
        return 1
    return n * factorial(n - 1)

def is_prime(num):
    """Check if a number is prime"""
    if num < 2:
        return False
    for i in range(2, int(num**0.5) + 1):
        if num % i == 0:
            return False
    return True

# Test functions
print(f"Factorial of 5: {factorial(5)}")
print(f"Factorial of 7: {factorial(7)}")

print("Prime numbers between 1 and 20:")
primes = [num for num in range(1, 21) if is_prime(num)]
print(f"  {primes}")
print()

# 6. Fibonacci Sequence
print("6. FIBONACCI SEQUENCE")
print("-" * 30)

def fibonacci(n):
    """Generate Fibonacci sequence"""
    sequence = []
    a, b = 0, 1
    for _ in range(n):
        sequence.append(a)
        a, b = b, a + b
    return sequence

fib_numbers = fibonacci(10)
print(f"First 10 Fibonacci numbers: {fib_numbers}")
print()

# 7. Current Date and Time
print("7. DATE AND TIME")
print("-" * 30)

from datetime import datetime
now = datetime.now()
print(f"Current date and time: {now.strftime('%Y-%m-%d %H:%M:%S')}")
print(f"Year: {now.year}")
print(f"Month: {now.month}")
print(f"Day: {now.day}")
print(f"Hour: {now.hour}")
print(f"Minute: {now.minute}")
print()

print("=" * 50)
print("PROGRAM EXECUTION COMPLETED SUCCESSFULLY!")
print("=" * 50)`,

                php: `<?php
// PHP Code Runner Example
echo "<!DOCTYPE html>";
echo "<html>";
echo "<head>";
echo "    <title>PHP Code Runner</title>";
echo "    <style>";
echo "        body { font-family: Arial, sans-serif; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }";
echo "        .container { background: rgba(255,255,255,0.9); padding: 30px; border-radius: 10px; color: #333; margin: 20px auto; max-width: 800px; }";
echo "        h1 { color: #4F5B93; }";
echo "        h2 { color: #5D6CC0; border-bottom: 2px solid #5D6CC0; padding-bottom: 5px; }";
echo "        .result { background: #e8f4fd; padding: 15px; border-radius: 5px; margin: 10px 0; color: #1e40af; }";
echo "        table { width: 100%; border-collapse: collapse; margin: 10px 0; }";
echo "        th { background: #4F5B93; color: white; padding: 10px; text-align: left; }";
echo "        td { padding: 8px; border-bottom: 1px solid #ddd; }";
echo "        tr:hover { background: #f5f5f5; }";
echo "        .success { color: #059669; font-weight: bold; }";
echo "        .error { color: #dc2626; }";
echo "    </style>";
echo "</head>";
echo "<body>";
echo "    <div class='container'>";
echo "        <h1>PHP Code Runner</h1>";
echo "        <p>Welcome to PHP testing environment!</p>";
echo "        <div class='result'>";
echo "            <h2>Server Information</h2>";
echo "            <p><strong>PHP Version:</strong> " . phpversion() . "</p>";
echo "            <p><strong>Server Software:</strong> " . $_SERVER['SERVER_SOFTWARE'] . "</p>";
echo "            <p><strong>Current Timestamp:</strong> " . date('Y-m-d H:i:s') . "</p>";
echo "            <p><strong>Timezone:</strong> " . date_default_timezone_get() . "</p>";
echo "        </div>";

// 1. Basic PHP Operations
echo "        <h2>1. Basic PHP Operations</h2>";
$num1 = 25;
$num2 = 7;
echo "        <p><strong>Number 1:</strong> $num1</p>";
echo "        <p><strong>Number 2:</strong> $num2</p>";
echo "        <p><strong>Addition:</strong> " . ($num1 + $num2) . "</p>";
echo "        <p><strong>Subtraction:</strong> " . ($num1 - $num2) . "</p>";
echo "        <p><strong>Multiplication:</strong> " . ($num1 * $num2) . "</p>";
echo "        <p><strong>Division:</strong> " . round($num1 / $num2, 2) . "</p>";
echo "        <p><strong>Modulus:</strong> " . ($num1 % $num2) . "</p>";

// 2. String Operations
echo "        <h2>2. String Operations</h2>";
$text = "Welcome to PHP Programming";
echo "        <p><strong>Original Text:</strong> $text</p>";
echo "        <p><strong>Length:</strong> " . strlen($text) . " characters</p>";
echo "        <p><strong>Uppercase:</strong> " . strtoupper($text) . "</p>";
echo "        <p><strong>Lowercase:</strong> " . strtolower($text) . "</p>";
echo "        <p><strong>First 7 characters:</strong> " . substr($text, 0, 7) . "</p>";
echo "        <p><strong>Word Count:</strong> " . str_word_count($text) . " words</p>";

// 3. Array Operations
echo "        <h2>3. Array Operations</h2>";
$fruits = array("Apple", "Banana", "Orange", "Mango", "Grape");
echo "        <p><strong>Fruits Array:</strong> " . implode(", ", $fruits) . "</p>";
echo "        <p><strong>Array Count:</strong> " . count($fruits) . " items</p>";

// Add and remove from array
array_push($fruits, "Pineapple");
echo "        <p><strong>After adding Pineapple:</strong> " . implode(", ", $fruits) . "</p>";

array_splice($fruits, array_search("Banana", $fruits), 1);
echo "        <p><strong>After removing Banana:</strong> " . implode(", ", $fruits) . "</p>";

// 4. Associative Array (Dictionary)
echo "        <h2>4. Student Information</h2>";
$student = array(
    "name" => "สมชาย",
    "age" => 20,
    "grades" => array(85, 90, 78, 92),
    "major" => "Computer Science"
);

echo "        <table>";
foreach ($student as $key => $value) {
    if ($key == "grades") {
        $grades_str = implode(", ", $value);
        $average = array_sum($value) / count($value);
        echo "        <tr><th>$key</th><td>$grades_str (Average: " . round($average, 2) . ")</td></tr>";
    } else {
        echo "        <tr><th>$key</th><td>$value</td></tr>";
    }
}
echo "        </table>";

// 5. Date and Time Functions
echo "        <h2>5. Date and Time</h2>";
date_default_timezone_set('Asia/Bangkok');
echo "        <p><strong>Current Date:</strong> " . date('d/m/Y') . "</p>";
echo "        <p><strong>Current Time:</strong> " . date('H:i:s') . "</p>";
echo "        <p><strong>Day of Week:</strong> " . date('l') . "</p>";
echo "        <p><strong>Month Name:</strong> " . date('F') . "</p>";

// 6. Function Examples
echo "        <h2>6. Function Examples</h2>";

function factorial($n) {
    if ($n <= 1) return 1;
    return $n * factorial($n - 1);
}

function is_prime($num) {
    if ($num < 2) return false;
    for ($i = 2; $i <= sqrt($num); $i++) {
        if ($num % $i == 0) return false;
    }
    return true;
}

echo "        <p><strong>Factorial of 5:</strong> " . factorial(5) . "</p>";
echo "        <p><strong>Factorial of 7:</strong> " . factorial(7) . "</p>";

echo "        <p><strong>Prime numbers 1-20:</strong> ";
$primes = array();
for ($i = 1; $i <= 20; $i++) {
    if (is_prime($i)) {
        $primes[] = $i;
    }
}
echo implode(", ", $primes) . "</p>";

// 7. Fibonacci Sequence
echo "        <h2>7. Fibonacci Sequence</h2>";
function fibonacci($n) {
    $sequence = array();
    $a = 0;
    $b = 1;
    for ($i = 0; $i < $n; $i++) {
        $sequence[] = $a;
        $temp = $a;
        $a = $b;
        $b = $temp + $b;
    }
    return $sequence;
}

$fib_numbers = fibonacci(10);
echo "        <p><strong>First 10 Fibonacci numbers:</strong> " . implode(", ", $fib_numbers) . "</p>";

echo "        <div class='result success'>";
echo "            <h3>Execution Summary</h3>";
echo "            <p>✓ PHP code executed successfully</p>";
echo "            <p>✓ All functions tested without errors</p>";
echo "            <p>✓ Server time: " . date('H:i:s') . "</p>";
echo "        </div>";

echo "    </div>";
echo "</body>";
echo "</html>";
?>`
            };
            
            // Language info
            const languageInfo = {
                html: { 
                    name: "HTML", 
                    extension: ".html", 
                    icon: "fab fa-html5", 
                    color: "text-orange-500",
                    mode: "htmlmixed"
                },
                javascript: { 
                    name: "JavaScript", 
                    extension: ".js", 
                    icon: "fab fa-js", 
                    color: "text-yellow-500",
                    mode: "javascript"
                },
                python: { 
                    name: "Python", 
                    extension: ".py", 
                    icon: "fab fa-python", 
                    color: "text-yellow-500",
                    mode: "python"
                },
                php: { 
                    name: "PHP", 
                    extension: ".php", 
                    icon: "fab fa-php", 
                    color: "text-indigo-500",
                    mode: "php"
                }
            };
            
            // Initialize CodeMirror
            function initCodeMirror() {
                const langInfo = languageInfo[currentLanguage];
                
                codeMirrorEditor = CodeMirror.fromTextArea(codeEditorTextarea, {
                    mode: langInfo.mode,
                    theme: "dracula",
                    lineNumbers: true,
                    lineWrapping: true,
                    indentUnit: 4,
                    tabSize: 4,
                    indentWithTabs: false,
                    electricChars: true,
                    autoCloseBrackets: true,
                    matchBrackets: true,
                    extraKeys: {
                        "Ctrl-Space": "autocomplete",
                        "Ctrl-S": saveCode,
                        "Ctrl-Enter": runCode,
                        "F11": toggleFullscreen
                    }
                });
                
                codeMirrorEditor.setSize("100%", "100%");
            }
            
            // Load saved code
            function loadSavedCode() {
                try {
                    const savedCode = localStorage.getItem(`codeTester_${currentLanguage}`);
                    if (savedCode) {
                        codeMirrorEditor.setValue(savedCode);
                        showNotification('โหลดโค้ดสำเร็จ', `โหลดโค้ด ${languageInfo[currentLanguage].name} ที่บันทึกไว้`, 'success');
                    } else {
                        codeMirrorEditor.setValue(codeExamples[currentLanguage]);
                    }
                } catch (e) {
                    console.error('Error loading saved code:', e);
                }
            }
            
            // Save code
            function saveCode() {
                const code = codeMirrorEditor.getValue();
                localStorage.setItem(`codeTester_${currentLanguage}`, code);
                showNotification('บันทึกสำเร็จ', 'บันทึกโค้ดเรียบร้อยแล้ว', 'success');
            }
            
            // Run code
            async function runCode() {
                if (isRunningCode) return;
                
                isRunningCode = true;
                const startTime = new Date();
                const code = codeMirrorEditor.getValue();
                
                runBtn.innerHTML = '<div class="loading"></div> รันโค้ด...';
                runBtn.classList.remove('run-button-animation');
                
                try {
                    let result;
                    
                    switch (currentLanguage) {
                        case 'html':
                            result = await runHtmlCode(code);
                            break;
                        case 'javascript':
                            result = await runJavaScriptCode(code);
                            break;
                        case 'python':
                            result = await runPythonCode(code);
                            break;
                        case 'php':
                            result = await runPhpCode(code);
                            break;
                        default:
                            throw new Error('ภาษาไม่รองรับ');
                    }
                    
                    const endTime = new Date();
                    const executionTime = endTime - startTime;
                    
                    lastUpdateEl.textContent = endTime.toLocaleTimeString('th-TH');
                    
                    showNotification('รันโค้ดสำเร็จ', `รันโค้ดเสร็จสิ้นใน ${executionTime}ms`, 'success');
                    
                } catch (error) {
                    console.error('Error running code:', error);
                    executionOutput.innerHTML = `
                        <div class="error-message">
                            <h3 class="font-bold">เกิดข้อผิดพลาด</h3>
                            <p>${escapeHtml(error.message)}</p>
                            <p class="mt-2 text-sm">โปรดตรวจสอบโค้ดของคุณอีกครั้ง</p>
                        </div>
                    `;
                    showNotification('เกิดข้อผิดพลาด', 'ไม่สามารถรันโค้ดได้', 'error');
                } finally {
                    isRunningCode = false;
                    runBtn.innerHTML = '<i class="fas fa-play-circle"></i> รันโค้ด';
                    runBtn.classList.add('run-button-animation');
                }
            }
            
            // Run HTML code
            function runHtmlCode(code) {
                return new Promise((resolve) => {
                    executionOutput.innerHTML = `
                        <iframe class="web-output" sandbox="allow-scripts allow-same-origin"></iframe>
                    `;
                    
                    const iframe = executionOutput.querySelector('iframe');
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    
                    iframeDoc.open();
                    iframeDoc.write(code);
                    iframeDoc.close();
                    
                    resolve();
                });
            }
            
            // Run JavaScript code
            function runJavaScriptCode(code) {
                return new Promise((resolve) => {
                    // Clear the output
                    executionOutput.innerHTML = `
                        <div class="js-output">
                            <h3 class="font-bold mb-4">JavaScript Output</h3>
                            <div id="js-console-output"></div>
                        </div>
                    `;
                    
                    const outputDiv = document.getElementById('js-console-output');
                    let consoleOutput = '';
                    
                    // Override console.log to capture output
                    const originalLog = console.log;
                    const originalError = console.error;
                    const originalWarn = console.warn;
                    
                    console.log = function(...args) {
                        consoleOutput += args.join(' ') + '\\n';
                        originalLog.apply(console, args);
                    };
                    
                    console.error = function(...args) {
                        consoleOutput += '[ERROR] ' + args.join(' ') + '\\n';
                        originalError.apply(console, args);
                    };
                    
                    console.warn = function(...args) {
                        consoleOutput += '[WARN] ' + args.join(' ') + '\\n';
                        originalWarn.apply(console, args);
                    };
                    
                    try {
                        // Create a sandbox for JavaScript execution
                        const script = document.createElement('script');
                        script.textContent = `
                            try {
                                // Create a simple DOM for JavaScript code
                                if (!document.getElementById('output')) {
                                    const div = document.createElement('div');
                                    div.id = 'output';
                                    document.body.appendChild(div);
                                }
                                
                                // Execute user code
                                ${code}
                            } catch(e) {
                                console.error('Execution Error:', e.message);
                            }
                        `;
                        
                        // Execute in the current document
                        document.head.appendChild(script);
                        document.head.removeChild(script);
                        
                        // Restore console functions
                        setTimeout(() => {
                            console.log = originalLog;
                            console.error = originalError;
                            console.warn = originalWarn;
                            
                            // Display captured output
                            if (consoleOutput.trim()) {
                                outputDiv.innerHTML = `<pre>${escapeHtml(consoleOutput)}</pre>`;
                            } else {
                                outputDiv.innerHTML = '<p>✓ JavaScript executed successfully (no console output)</p>';
                            }
                            
                            resolve();
                        }, 100);
                        
                    } catch (e) {
                        console.log = originalLog;
                        console.error = originalError;
                        console.warn = originalWarn;
                        
                        throw new Error(`JavaScript Error: ${e.message}`);
                    }
                });
            }
            
            // Run Python code (simulated)
            function runPythonCode(code) {
                return new Promise((resolve) => {
                    // Simple Python interpreter simulation
                    let output = '';
                    
                    // Remove comments and empty lines
                    const lines = code.split('\\n').filter(line => 
                        line.trim() && !line.trim().startsWith('#')
                    );
                    
                    // Basic Python simulation
                    lines.forEach(line => {
                        if (line.includes('print(')) {
                            const match = line.match(/print\(["']([^"']+)["']\)/);
                            if (match) {
                                output += match[1] + '\\n';
                            }
                        }
                    });
                    
                    if (!output.trim()) {
                        output = '✓ Python code executed successfully\\n✓ Use print() function to see output';
                    }
                    
                    executionOutput.innerHTML = `
                        <div class="run-output">
                            <h3 class="font-bold mb-4">Python Output</h3>
                            <pre class="output-area">${escapeHtml(output)}</pre>
                            <p class="mt-4 text-sm text-gray-600">
                                Note: This is a simulated Python environment. For full Python features, 
                                use a dedicated Python IDE or server.
                            </p>
                        </div>
                    `;
                    
                    resolve();
                });
            }
            
            // Run PHP code
            function runPhpCode(code) {
                return new Promise((resolve) => {
                    // Check if PHP code contains PHP tags
                    if (!code.includes('<?php') && !code.includes('<?=')) {
                        // If no PHP tags, wrap it
                        code = '<?php\\n' + code + '\\n?>';
                    }
                    
                    // Simple PHP simulation - we'll parse basic PHP constructs
                    let output = '';
                    
                    // Extract echo statements
                    const echoMatches = code.match(/echo\s+["']([^"']+)["']/g) || [];
                    const printMatches = code.match(/print\s+["']([^"']+)["']/g) || [];
                    
                    echoMatches.forEach(match => {
                        output += match.replace(/echo\s+["']/, '').replace(/["']/, '') + '\\n';
                    });
                    
                    printMatches.forEach(match => {
                        output += match.replace(/print\s+["']/, '').replace(/["']/, '') + '\\n';
                    });
                    
                    if (output.trim()) {
                        executionOutput.innerHTML = `
                            <div class="php-output">
                                <h3 class="font-bold mb-4">PHP Output</h3>
                                <pre class="output-area">${escapeHtml(output)}</pre>
                            </div>
                        `;
                    } else {
                        executionOutput.innerHTML = `
                            <div class="run-output">
                                <h3 class="font-bold mb-4">PHP Execution</h3>
                                <div class="success-message">
                                    <p>✓ PHP code executed successfully</p>
                                    <p class="mt-2 text-sm">Note: Full PHP execution requires a server environment.</p>
                                </div>
                            </div>
                        `;
                    }
                    
                    resolve();
                });
            }
            
            // Change language
            function changeLanguage(lang) {
                if (lang === currentLanguage) return;
                
                // Save current code
                const currentCode = codeMirrorEditor.getValue();
                localStorage.setItem(`codeTester_${currentLanguage}`, currentCode);
                
                // Update current language
                currentLanguage = lang;
                const langInfo = languageInfo[lang];
                
                // Update UI
                currentLanguageEl.textContent = langInfo.name;
                editorTitle.textContent = `${langInfo.name} Editor`;
                previewTitle.textContent = `${langInfo.name} Output`;
                
                // Update language selector button
                languageSelectorBtn.innerHTML = `
                    <i class="${langInfo.icon} ${langInfo.color}"></i>
                    <span>${langInfo.name}</span>
                    <i class="fas fa-chevron-down ml-1"></i>
                `;
                
                // Update dropdown active state
                document.querySelectorAll('.language-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.lang === lang) {
                        option.classList.add('active');
                    }
                });
                
                // Update filename and extension
                filenameInput.value = `my-code${langInfo.extension}`;
                fileExtensionText.textContent = `ไฟล์จะถูกดาวน์โหลดเป็นไฟล์ ${langInfo.extension}`;
                
                // Update CodeMirror mode
                codeMirrorEditor.setOption('mode', langInfo.mode);
                
                // Load saved code for new language
                loadSavedCode();
                
                // Clear output
                executionOutput.innerHTML = `
                    <div class="run-output">
                        <div id="run-result" class="output-area">
                            โหลดภาษา ${langInfo.name} สำเร็จ พร้อมใช้งาน
                        </div>
                    </div>
                `;
                
                showNotification('เปลี่ยนภาษา', `เปลี่ยนภาษาเป็น ${langInfo.name}`, 'success');
            }
            
            // Toggle theme
            function toggleTheme() {
                const htmlElement = document.documentElement;
                isDarkMode = !isDarkMode;
                
                if (isDarkMode) {
                    htmlElement.classList.add('dark');
                    themeText.textContent = 'ดาร์ก';
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i><span>ดาร์ก</span>';
                    themeToggle.classList.remove('bg-gray-200', 'text-gray-800');
                    themeToggle.classList.add('bg-gray-800', 'text-white');
                    codeMirrorEditor.setOption('theme', 'dracula');
                } else {
                    htmlElement.classList.remove('dark');
                    themeText.textContent = 'ไลต์';
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i><span>ไลต์</span>';
                    themeToggle.classList.remove('bg-gray-800', 'text-white');
                    themeToggle.classList.add('bg-gray-200', 'text-gray-800');
                    codeMirrorEditor.setOption('theme', 'default');
                }
                
                localStorage.setItem('codeTesterTheme', isDarkMode ? 'dark' : 'light');
            }
            
            // Toggle fullscreen
            function toggleFullscreen() {
                isFullscreen = !isFullscreen;
                
                if (isFullscreen) {
                    editorSection.classList.add('fullscreen');
                    fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i><span class="hidden md:inline">ย่อ</span>';
                    fullscreenBtn.classList.remove('bg-gray-700');
                    fullscreenBtn.classList.add('bg-yellow-600');
                    previewSection.style.display = 'none';
                    resizer.style.display = 'none';
                } else {
                    editorSection.classList.remove('fullscreen');
                    fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i><span class="hidden md:inline">เต็มจอ</span>';
                    fullscreenBtn.classList.remove('bg-yellow-600');
                    fullscreenBtn.classList.add('bg-gray-700');
                    previewSection.style.display = 'flex';
                    resizer.style.display = 'block';
                }
            }
            
            // Reset code
            function resetCode() {
                if (confirm(`คุณแน่ใจที่จะรีเซ็ตโค้ด ${languageInfo[currentLanguage].name} ทั้งหมด?`)) {
                    codeMirrorEditor.setValue(codeExamples[currentLanguage]);
                    showNotification('รีเซ็ตสำเร็จ', `รีเซ็ตโค้ด ${languageInfo[currentLanguage].name} เป็นค่าเริ่มต้นแล้ว`, 'success');
                }
            }
            
            // Show download modal
            function showDownloadModal() {
                downloadModal.classList.add('show');
                filenameInput.focus();
                filenameInput.select();
            }
            
            // Hide download modal
            function hideDownloadModal() {
                downloadModal.classList.remove('show');
            }
            
            // Download code
            function downloadCode() {
                const content = codeMirrorEditor.getValue();
                const filename = filenameInput.value || `my-code${languageInfo[currentLanguage].extension}`;
                
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                
                setTimeout(() => {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 100);
                
                hideDownloadModal();
                showNotification('ดาวน์โหลดสำเร็จ', `ดาวน์โหลดไฟล์ "${filename}" เรียบร้อยแล้ว`, 'success');
            }
            
            // Show notification
            function showNotification(title, message, type = 'success') {
                notificationTitle.textContent = title;
                notificationText.textContent = message;
                
                notificationContent.className = 'notification-content';
                notificationContent.classList.add(`notification-${type}`);
                
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 4000);
            }
            
            // Escape HTML
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
            
            // Setup resizer
            function setupResizer() {
                resizer.addEventListener('mousedown', function(e) {
                    isResizing = true;
                    resizer.classList.add('active');
                    document.body.style.cursor = 'col-resize';
                    e.preventDefault();
                });
                
                document.addEventListener('mousemove', function(e) {
                    if (!isResizing) return;
                    
                    const containerWidth = document.querySelector('.split-container').offsetWidth;
                    const mouseX = e.clientX;
                    const containerLeft = document.querySelector('.split-container').getBoundingClientRect().left;
                    
                    editorWidth = ((mouseX - containerLeft) / containerWidth) * 100;
                    
                    if (editorWidth < 20) editorWidth = 20;
                    if (editorWidth > 80) editorWidth = 80;
                    
                    editorSection.style.width = `${editorWidth}%`;
                    previewSection.style.width = `${100 - editorWidth}%`;
                });
                
                document.addEventListener('mouseup', function() {
                    if (isResizing) {
                        isResizing = false;
                        resizer.classList.remove('active');
                        document.body.style.cursor = '';
                        localStorage.setItem('codeTesterEditorWidth', editorWidth);
                    }
                });
                
                const savedWidth = localStorage.getItem('codeTesterEditorWidth');
                if (savedWidth) {
                    editorWidth = parseFloat(savedWidth);
                    editorSection.style.width = `${editorWidth}%`;
                    previewSection.style.width = `${100 - editorWidth}%`;
                }
            }
            
            // Setup keyboard shortcuts
            function setupKeyboardShortcuts() {
                document.addEventListener('keydown', function(e) {
                    if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                        e.preventDefault();
                        saveCode();
                    }
                    
                    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                        e.preventDefault();
                        runCode();
                    }
                    
                    if (e.key === 'F11') {
                        e.preventDefault();
                        toggleFullscreen();
                    }
                    
                    if (e.key === 'Escape' && isFullscreen) {
                        toggleFullscreen();
                    }
                    
                    if (e.key === 'Escape' && downloadModal.classList.contains('show')) {
                        hideDownloadModal();
                    }
                    
                    // Language switching with Ctrl+1-4
                    if ((e.ctrlKey || e.metaKey) && e.key >= '1' && e.key <= '4') {
                        e.preventDefault();
                        const langs = ['html', 'javascript', 'python', 'php'];
                        const langIndex = parseInt(e.key) - 1;
                        if (langs[langIndex]) {
                            changeLanguage(langs[langIndex]);
                        }
                    }
                });
            }
            
            // Setup event listeners
            function setupEventListeners() {
                runBtn.addEventListener('click', runCode);
                quickRunBtn.addEventListener('click', runCode);
                themeToggle.addEventListener('click', toggleTheme);
                fullscreenBtn.addEventListener('click', toggleFullscreen);
                resetBtn.addEventListener('click', resetCode);
                downloadBtn.addEventListener('click', showDownloadModal);
                confirmDownloadBtn.addEventListener('click', downloadCode);
                cancelDownloadBtn.addEventListener('click', hideDownloadModal);
                
                languageSelectorBtn.addEventListener('click', function() {
                    languageDropdown.classList.toggle('show');
                });
                
                document.querySelectorAll('.language-option').forEach(option => {
                    option.addEventListener('click', function() {
                        const lang = this.dataset.lang;
                        changeLanguage(lang);
                        languageDropdown.classList.remove('show');
                    });
                });
                
                document.addEventListener('click', function(e) {
                    if (!languageSelectorBtn.contains(e.target) && !languageDropdown.contains(e.target)) {
                        languageDropdown.classList.remove('show');
                    }
                });
                
                exampleBtn.addEventListener('click', function() {
                    codeMirrorEditor.setValue(codeExamples[currentLanguage]);
                    showNotification('โหลดตัวอย่าง', `โหลดตัวอย่างโค้ด ${languageInfo[currentLanguage].name}`, 'success');
                });
                
                downloadModal.addEventListener('click', function(e) {
                    if (e.target === downloadModal) {
                        hideDownloadModal();
                    }
                });
                
                filenameInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        downloadCode();
                    }
                });
            }
            
            // Load theme
            function loadTheme() {
                const savedTheme = localStorage.getItem('codeTesterTheme');
                if (savedTheme === 'light') {
                    toggleTheme();
                }
            }
            
            // Initialize app
            function initApp() {
                loadTheme();
                initCodeMirror();
                setupEventListeners();
                setupResizer();
                setupKeyboardShortcuts();
                loadSavedCode();
                
                setTimeout(() => {
                    showNotification('ยินดีต้อนรับ', 'Live Code Tester Pro พร้อมใช้งานแล้ว!', 'success');
                }, 1000);
            }
            
            // Start the app
            initApp();
        });
    </script>
</body>
</html>
