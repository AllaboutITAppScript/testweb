<!DOCTYPE html>
<html lang="th" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Code Tester Pro - Multi-language Code Editor</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Animate.css for animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <!-- Monaco Editor (CodeMirror fallback) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/theme/dracula.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/clike/clike.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/php/php.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/htmlmixed/htmlmixed.min.js"></script>
    <!-- Skulpt สำหรับรัน Python ในเบราว์เซอร์ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/skulpt/1.2.0/skulpt.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/skulpt/1.2.0/skulpt-stdlib.js"></script>
    <!-- PHP.js สำหรับรัน PHP ในเบราว์เซอร์ -->
    <script src="https://cdn.jsdelivr.net/npm/php-wasm@latest/dist/index.js"></script>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .resizer {
            position: absolute;
            top: 0;
            right: -5px;
            width: 10px;
            height: 100%;
            cursor: col-resize;
            z-index: 50;
        }
        
        .resizer:hover {
            background-color: rgba(59, 130, 246, 0.3);
        }
        
        .resizer.active {
            background-color: rgba(59, 130, 246, 0.5);
        }
        
        .code-editor {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            tab-size: 2;
            caret-color: white;
            white-space: pre;
            overflow-wrap: normal;
        }
        
        .code-editor:focus {
            outline: none;
        }
        
        .preview-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
            border-radius: 0.5rem;
        }
        
        .dark .preview-frame {
            background: #1e293b;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .live-indicator {
            animation: pulse 2s infinite;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #374151;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #6b7280;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }
        
        /* Split view layout */
        .split-container {
            display: flex;
            height: calc(100vh - 120px);
            position: relative;
            overflow: hidden;
        }
        
        .editor-section {
            width: 50%;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .preview-section {
            width: 50%;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* Editor with line numbers */
        .editor-wrapper {
            position: relative;
            flex: 1;
            overflow: hidden;
        }
        
        .line-numbers {
            position: absolute;
            left: 0;
            top: 0;
            width: 50px;
            height: 100%;
            background-color: #1f2937;
            color: #9ca3af;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.5;
            text-align: right;
            padding-top: 16px;
            padding-right: 10px;
            overflow: hidden;
            user-select: none;
            border-right: 1px solid #374151;
            z-index: 1;
        }
        
        .line-number {
            padding: 0 5px;
            height: 21px; /* Adjust based on line-height */
            display: block;
        }
        
        .line-number.current-line {
            background-color: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
            font-weight: bold;
        }
        
        .line-number:hover {
            background-color: rgba(59, 130, 246, 0.1);
        }
        
        .text-editor {
            position: absolute;
            left: 50px;
            top: 0;
            width: calc(100% - 50px);
            height: 100%;
            background-color: transparent;
            color: #f3f4f6;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            border: none;
            padding: 16px 10px;
            resize: none;
            white-space: pre;
            overflow-wrap: normal;
            overflow: auto;
            z-index: 2;
        }
        
        .CodeMirror {
            height: 100% !important;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace !important;
            font-size: 14px !important;
        }
        
        .CodeMirror-gutters {
            background-color: #1f2937 !important;
            border-right: 1px solid #374151 !important;
        }
        
        .CodeMirror-linenumber {
            color: #9ca3af !important;
        }
        
        /* Fullscreen mode */
        .fullscreen {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 1000 !important;
            margin: 0 !important;
            border-radius: 0 !important;
            border: none !important;
        }
        
        .fullscreen .text-editor {
            font-size: 16px !important;
            padding: 20px !important;
        }
        
        .fullscreen .line-numbers {
            width: 60px !important;
            font-size: 16px !important;
            padding-top: 20px !important;
        }
        
        .fullscreen .text-editor {
            left: 60px !important;
            width: calc(100% - 60px) !important;
        }
        
        /* Beautiful Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: -400px;
            z-index: 1000;
            transition: right 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            max-width: 350px;
        }
        
        .notification.show {
            right: 20px;
        }
        
        .notification-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .notification-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: rgba(255, 255, 255, 0.3);
        }
        
        .notification-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .notification-error {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        .notification-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .notification-info {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        }
        
        /* Modal for download */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background-color: #1f2937;
            border-radius: 15px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            transform: translateY(0);
            animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Language selector */
        .language-selector {
            position: relative;
            z-index: 10;
        }
        
        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: #1f2937;
            border: 1px solid #374151;
            border-radius: 0.5rem;
            padding: 0.5rem 0;
            min-width: 180px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 100;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .language-dropdown.show {
            display: block;
            animation: fadeInDown 0.3s ease;
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .language-option {
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            border-left: 3px solid transparent;
        }
        
        .language-option:hover {
            background-color: #374151;
            border-left-color: #3b82f6;
        }
        
        .language-option.active {
            background-color: rgba(59, 130, 246, 0.2);
            border-left-color: #3b82f6;
        }
        
        /* Preview mode buttons */
        .preview-modes {
            display: flex;
            gap: 0.5rem;
            margin-right: 1rem;
        }
        
        .preview-mode-btn {
            padding: 0.5rem 1rem;
            background-color: #374151;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .preview-mode-btn:hover {
            background-color: #4b5563;
            transform: translateY(-2px);
        }
        
        .preview-mode-btn.active {
            background-color: #3b82f6;
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        /* Screen size modal */
        .screen-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        
        .screen-modal.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .screen-modal-content {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            background-color: #1f2937;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }
        
        .screen-modal-header {
            padding: 1rem;
            background-color: #111827;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #374151;
        }
        
        .screen-modal-body {
            flex: 1;
            padding: 0.5rem;
            overflow: auto;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }
        
        .screen-modal-frame {
            border: none;
            background-color: white;
            border-radius: 0.375rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .screen-size-info {
            background-color: #374151;
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        /* Console output */
        .console-output {
            background-color: #0f172a;
            color: #e2e8f0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            padding: 1rem;
            overflow: auto;
            height: 100%;
            border-radius: 0.375rem;
        }
        
        .console-line {
            margin-bottom: 0.25rem;
            white-space: pre-wrap;
        }
        
        .console-command {
            color: #10b981;
        }
        
        .console-output-text {
            color: #e2e8f0;
        }
        
        .console-error {
            color: #ef4444;
        }
        
        .console-warning {
            color: #f59e0b;
        }
        
        .console-info {
            color: #3b82f6;
        }
        
        .console-success {
            color: #10b981;
        }
        
        /* Run code button animation */
        @keyframes runButtonPulse {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
        
        .run-button-animation {
            animation: runButtonPulse 1.5s infinite;
        }
        
        /* Code execution result panel */
        .execution-result {
            background-color: #1e293b;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            border-left: 4px solid #3b82f6;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .execution-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #374151;
        }
        
        .execution-time {
            color: #94a3b8;
            font-size: 0.875rem;
        }
        
        /* Tab system for output */
        .output-tabs {
            display: flex;
            border-bottom: 1px solid #374151;
            margin-bottom: 1rem;
        }
        
        .output-tab {
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }
        
        .output-tab:hover {
            background-color: #374151;
        }
        
        .output-tab.active {
            border-bottom-color: #3b82f6;
            color: #3b82f6;
            font-weight: 600;
        }
        
        .output-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .output-content.active {
            display: block;
        }
        
        /* Floating action button */
        .floating-action-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s;
            border: none;
        }
        
        .floating-action-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 30px rgba(59, 130, 246, 0.4);
        }
        
        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #3b82f6;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Custom highlight for line numbers */
        .line-number.highlight {
            animation: highlightLine 1s ease;
            background-color: rgba(59, 130, 246, 0.3);
        }
        
        @keyframes highlightLine {
            0% { background-color: rgba(59, 130, 246, 0); }
            50% { background-color: rgba(59, 130, 246, 0.5); }
            100% { background-color: rgba(59, 130, 246, 0.3); }
        }
        
        /* Code execution area */
        .code-execution {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .execution-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #1e293b;
            border-bottom: 1px solid #374151;
        }
        
        .execution-content {
            flex: 1;
            overflow: auto;
            padding: 15px;
            background: white;
            color: black;
        }
        
        .dark .execution-content {
            background: #0f172a;
            color: white;
        }
        
        /* Output styling for different languages */
        .output-area {
            white-space: pre-wrap;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* Iframe for web output */
        .web-output {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        /* Run output styles */
        .run-output {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            margin-top: 10px;
            border-left: 4px solid #3b82f6;
        }
        
        .dark .run-output {
            background: #1e293b;
        }
        
        /* Syntax highlighting */
        .cm-s-dracula.CodeMirror {
            background-color: #1e293b !important;
            color: #f8f8f2 !important;
        }
        
        .cm-s-dracula .CodeMirror-gutters {
            background-color: #1e293b !important;
            border-right: 1px solid #374151 !important;
        }
        
        .cm-s-dracula .CodeMirror-linenumber {
            color: #9ca3af !important;
        }
    </style>
</head>
<body class="dark:bg-gray-900 dark:text-gray-200 bg-gray-100 text-gray-800 transition-colors duration-300">
    <!-- Beautiful Notification -->
    <div id="notification" class="notification">
        <div class="notification-content" id="notification-content">
            <div class="flex items-center">
                <i class="fas fa-check-circle text-xl mr-3"></i>
                <div>
                    <h4 class="font-bold" id="notification-title">ดำเนินการสำเร็จ</h4>
                    <p class="text-sm opacity-90" id="notification-text">ระบบได้บันทึกโค้ดของคุณแล้ว</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Download Modal -->
    <div id="download-modal" class="modal">
        <div class="modal-content">
            <h3 class="text-xl font-bold mb-4 flex items-center">
                <i class="fas fa-download mr-2 text-blue-500"></i> ดาวน์โหลดไฟล์โค้ด
            </h3>
            <div class="mb-6">
                <label for="filename" class="block mb-2 font-medium">ชื่อไฟล์:</label>
                <input type="text" id="filename" class="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" value="my-code.html">
                <p class="text-sm text-gray-400 mt-2" id="file-extension">ไฟล์จะถูกดาวน์โหลดเป็นไฟล์ .html</p>
            </div>
            <div class="flex justify-end space-x-3">
                <button id="cancel-download" class="px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors">ยกเลิก</button>
                <button id="confirm-download" class="px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors flex items-center">
                    <i class="fas fa-download mr-2"></i> ดาวน์โหลด
                </button>
            </div>
        </div>
    </div>
    
    <!-- Screen Preview Modal -->
    <div id="screen-modal" class="screen-modal">
        <div class="screen-modal-content">
            <div class="screen-modal-header">
                <div class="flex items-center space-x-4">
                    <h3 class="text-xl font-bold flex items-center">
                        <i class="fas fa-desktop mr-2 text-blue-500"></i> หน้าจอใหญ่สำหรับทดสอบ
                    </h3>
                    <div id="screen-size-display" class="screen-size-info">ขนาด: เดสก์ท็อป</div>
                </div>
                <div class="flex items-center space-x-3">
                    <button id="mobile-screen" class="preview-mode-btn">
                        <i class="fas fa-mobile-alt"></i> มือถือ
                    </button>
                    <button id="tablet-screen" class="preview-mode-btn">
                        <i class="fas fa-tablet-alt"></i> แท็บเล็ต
                    </button>
                    <button id="desktop-screen" class="preview-mode-btn active">
                        <i class="fas fa-desktop"></i> เดสก์ท็อป
                    </button>
                    <button id="full-screen" class="preview-mode-btn">
                        <i class="fas fa-expand"></i> เต็มจอ
                    </button>
                    <button id="close-screen-modal" class="px-4 py-2 bg-red-600 rounded-lg hover:bg-red-700 transition-colors flex items-center">
                        <i class="fas fa-times mr-2"></i> ปิด
                    </button>
                </div>
            </div>
            <div class="screen-modal-body">
                <iframe id="screen-frame" class="screen-modal-frame"></iframe>
            </div>
        </div>
    </div>
    
    <!-- Floating Action Button for Quick Actions -->
    <button id="quick-run-btn" class="floating-action-btn" title="รันโค้ด (Ctrl+Enter)">
        <i class="fas fa-play"></i>
    </button>
    
    <div class="container mx-auto px-4 py-2 h-screen flex flex-col">
        <!-- Header -->
        <header class="flex flex-col md:flex-row justify-between items-center mb-4 py-3">
            <div class="flex items-center space-x-3 mb-3 md:mb-0">
                <div class="bg-gradient-to-br from-blue-600 to-purple-600 p-2 rounded-lg shadow-lg">
                    <i class="fas fa-code text-white text-xl"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold bg-gradient-to-r from-blue-500 to-purple-500 bg-clip-text text-transparent">Live Code Tester Pro</h1>
                    <p class="text-sm text-gray-500 dark:text-gray-400">ทดสอบโค้ดหลายภาษาแบบเรียลไทม์</p>
                </div>
            </div>
            
            <!-- Controls -->
            <div class="flex flex-wrap gap-3 items-center">
                <div class="flex items-center space-x-2">
                    <span class="text-sm hidden md:block">ภาษา:</span>
                    <div class="language-selector">
                        <button id="language-selector-btn" class="bg-gray-800 dark:bg-gray-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-gray-700 dark:hover:bg-gray-600 transition-colors shadow-md">
                            <i class="fab fa-html5 text-orange-500"></i>
                            <span id="current-language">HTML</span>
                            <i class="fas fa-chevron-down ml-1"></i>
                        </button>
                        <div id="language-dropdown" class="language-dropdown">
                            <div class="language-option active" data-lang="html">
                                <i class="fab fa-html5 mr-2 text-orange-500"></i>
                                <div>
                                    <div class="font-medium">HTML</div>
                                    <div class="text-xs text-gray-400">สำหรับเว็บเพจ</div>
                                </div>
                            </div>
                            <div class="language-option" data-lang="javascript">
                                <i class="fab fa-js mr-2 text-yellow-500"></i>
                                <div>
                                    <div class="font-medium">JavaScript</div>
                                    <div class="text-xs text-gray-400">ภาษาสคริปต์</div>
                                </div>
                            </div>
                            <div class="language-option" data-lang="python">
                                <i class="fab fa-python mr-2 text-yellow-500"></i>
                                <div>
                                    <div class="font-medium">Python</div>
                                    <div class="text-xs text-gray-400">ภาษาสคริปต์</div>
                                </div>
                            </div>
                            <div class="language-option" data-lang="csharp">
                                <i class="fas fa-code mr-2 text-purple-500"></i>
                                <div>
                                    <div class="font-medium">C#</div>
                                    <div class="text-xs text-gray-400">Microsoft .NET</div>
                                </div>
                            </div>
                            <div class="language-option" data-lang="cpp">
                                <i class="fas fa-cog mr-2 text-blue-500"></i>
                                <div>
                                    <div class="font-medium">C++</div>
                                    <div class="text-xs text-gray-400">ภาษาเชิงระบบ</div>
                                </div>
                            </div>
                            <div class="language-option" data-lang="php">
                                <i class="fab fa-php mr-2 text-indigo-500"></i>
                                <div>
                                    <div class="font-medium">PHP</div>
                                    <div class="text-xs text-gray-400">เว็บเซิร์ฟเวอร์</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex items-center space-x-2">
                    <span class="text-sm hidden md:block">ธีม:</span>
                    <button id="theme-toggle" class="bg-gray-800 dark:bg-gray-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-gray-700 dark:hover:bg-gray-600 transition-colors shadow-md">
                        <i class="fas fa-moon"></i>
                        <span id="theme-text">ดาร์ก</span>
                    </button>
                </div>
                
                <div class="flex items-center space-x-2">
                    <span class="text-sm hidden md:block">อัปเดต:</span>
                    <div class="flex space-x-2">
                        <button id="live-toggle" class="bg-green-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-green-700 transition-colors shadow-md">
                            <i class="fas fa-play"></i>
                            <span id="live-text">Live</span>
                        </button>
                        <button id="run-btn" class="bg-gradient-to-r from-blue-500 to-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:from-blue-600 hover:to-blue-800 transition-all shadow-md run-button-animation">
                            <i class="fas fa-play-circle"></i>
                            <span>รันโค้ด</span>
                        </button>
                    </div>
                </div>
                
                <button id="download-btn" class="bg-gradient-to-r from-purple-500 to-purple-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:from-purple-600 hover:to-purple-800 transition-all shadow-md">
                    <i class="fas fa-download"></i>
                    <span>ดาวน์โหลด</span>
                </button>
                
                <button id="reset-btn" class="bg-gradient-to-r from-red-500 to-red-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:from-red-600 hover:to-red-800 transition-all shadow-md">
                    <i class="fas fa-trash-alt"></i>
                    <span>รีเซ็ต</span>
                </button>
            </div>
        </header>
        
        <!-- Live Indicator -->
        <div class="flex items-center justify-center mb-2">
            <div id="live-indicator" class="flex items-center space-x-2 bg-gradient-to-r from-green-900 to-green-700 text-green-200 px-4 py-2 rounded-lg shadow">
                <i class="fas fa-circle live-indicator"></i>
                <span id="live-status-text">อัปเดตแบบเรียลไทม์</span>
            </div>
        </div>
        
        <!-- Split View Container -->
        <div class="split-container">
            <!-- Editor Panel -->
            <div class="editor-section bg-gray-900 dark:bg-gray-800 rounded-lg border border-gray-700 relative shadow-lg">
                <div class="flex justify-between items-center bg-gradient-to-r from-gray-800 to-gray-900 dark:from-gray-900 dark:to-gray-800 px-4 py-3 rounded-t-lg border-b border-gray-700">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-code text-green-400"></i>
                        <h2 class="font-bold" id="editor-title">HTML Editor</h2>
                        <span class="text-xs bg-blue-900 text-blue-200 px-2 py-1 rounded">Line Numbers: ON</span>
                        <div class="example-selector">
                            <button id="example-btn" class="example-btn">
                                <i class="fas fa-code-branch"></i> ตัวอย่างโค้ด
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="text-sm text-gray-400 hidden md:block">
                            <i class="fas fa-expand-arrows-alt mr-1"></i>
                            <span>ลากเส้นแบ่งเพื่อปรับขนาด</span>
                        </div>
                        <button id="fullscreen-btn" class="ml-2 bg-gray-700 text-white px-3 py-1.5 rounded-lg flex items-center space-x-2 hover:bg-gray-600 transition-colors">
                            <i class="fas fa-expand"></i>
                            <span class="hidden md:inline">เต็มจอ</span>
                        </button>
                    </div>
                </div>
                
                <div class="editor-wrapper">
                    <div id="line-numbers-container" class="line-numbers">
                        <!-- Line numbers will be generated here -->
                    </div>
                    <textarea id="code-editor" class="text-editor" spellcheck="false" placeholder="เริ่มต้นเขียนโค้ดที่นี่..."></textarea>
                </div>
                
                <!-- Resizer -->
                <div class="resizer"></div>
            </div>
            
            <!-- Preview Panel -->
            <div class="preview-section bg-gray-800 dark:bg-gray-700 rounded-lg border border-gray-700 shadow-lg">
                <div class="flex justify-between items-center bg-gradient-to-r from-gray-800 to-gray-900 dark:from-gray-900 dark:to-gray-800 px-4 py-3 rounded-t-lg border-b border-gray-700">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-eye text-blue-400"></i>
                        <h2 class="font-bold">ผลลัพธ์</h2>
                    </div>
                    <div class="flex items-center">
                        <div class="preview-modes">
                            <button id="preview-html" class="preview-mode-btn active">
                                <i class="fas fa-code"></i> Preview
                            </button>
                            <button id="preview-console" class="preview-mode-btn">
                                <i class="fas fa-terminal"></i> Console
                            </button>
                            <button id="preview-screen" class="preview-mode-btn">
                                <i class="fas fa-desktop"></i> หน้าจอใหญ่
                            </button>
                        </div>
                        <div class="text-sm text-gray-400 ml-4">
                            <i class="fas fa-clock mr-1"></i>
                            <span>อัปเดตล่าสุด: <span id="last-update">-</span></span>
                        </div>
                    </div>
                </div>
                
                <div class="flex-1 p-2 overflow-hidden">
                    <!-- Output Tabs -->
                    <div class="output-tabs">
                        <div class="output-tab active" data-tab="preview">Preview</div>
                        <div class="output-tab" data-tab="console">Console</div>
                        <div class="output-tab" data-tab="result">ผลการรัน</div>
                    </div>
                    
                    <!-- Output Contents -->
                    <div id="preview-content" class="output-content active h-full">
                        <div class="code-execution">
                            <div class="execution-header">
                                <h4 class="font-bold">ผลลัพธ์</h4>
                                <div class="text-sm text-gray-500">แสดงผลการรันโค้ดที่นี่</div>
                            </div>
                            <div id="execution-output" class="execution-content">
                                <div class="run-output">
                                    <div id="run-result" class="output-area">
                                        ระบบพร้อมใช้งาน โปรดเขียนโค้ดและคลิก "รันโค้ด"
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="console-content" class="output-content h-full">
                        <div class="console-output">
                            <div class="console-line console-command">$ ระบบคอนโซลพร้อมใช้งาน</div>
                            <div class="console-line console-info">$ พิมพ์โค้ดในแถบด้านซ้าย แล้วคลิกปุ่ม "รันโค้ด"</div>
                            <div id="console-output-content"></div>
                        </div>
                    </div>
                    
                    <div id="result-content" class="output-content h-full">
                        <div class="console-output">
                            <div class="execution-result">
                                <div class="execution-header">
                                    <h4 class="font-bold text-lg">ผลการรันโค้ด</h4>
                                    <div class="execution-time" id="execution-time">-</div>
                                </div>
                                <div id="execution-result-content">
                                    <div class="console-line console-info">ยังไม่ได้รันโค้ด</div>
                                    <div class="console-line console-info">คลิกปุ่ม "รันโค้ด" เพื่อทดสอบโค้ดของคุณ</div>
                                </div>
                            </div>
                            <div class="mt-4">
                                <h4 class="font-bold mb-2">สถิติ</h4>
                                <div class="grid grid-cols-2 gap-2 text-sm">
                                    <div class="bg-gray-800 p-2 rounded">
                                        <div class="text-gray-400">ภาษา</div>
                                        <div id="stat-language" class="font-medium">HTML</div>
                                    </div>
                                    <div class="bg-gray-800 p-2 rounded">
                                        <div class="text-gray-400">บรรทัด</div>
                                        <div id="stat-lines" class="font-medium">0</div>
                                    </div>
                                    <div class="bg-gray-800 p-2 rounded">
                                        <div class="text-gray-400">ขนาดไฟล์</div>
                                        <div id="stat-size" class="font-medium">0 KB</div>
                                    </div>
                                    <div class="bg-gray-800 p-2 rounded">
                                        <div class="text-gray-400">เวลารันล่าสุด</div>
                                        <div id="stat-last-run" class="font-medium">-</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="mt-4 pt-3 border-t border-gray-700">
            <div class="flex flex-col md:flex-row justify-between items-center text-sm text-gray-500 dark:text-gray-400">
                <div class="mb-2 md:mb-0 text-center md:text-left">
                    <p class="flex items-center">
                        <i class="fas fa-code mr-1"></i> Live Code Tester Pro - รองรับ HTML, JavaScript, Python, C#, C++, PHP
                    </p>
                </div>
                <div class="flex flex-wrap justify-center gap-4">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-keyboard"></i>
                        <span>กด <kbd class="px-2 py-1 bg-gray-800 rounded shadow">Ctrl+S</kbd> เพื่อบันทึก</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-bolt"></i>
                        <span>กด <kbd class="px-2 py-1 bg-gray-800 rounded shadow">Ctrl+Enter</kbd> เพื่อรันโค้ด</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-expand"></i>
                        <span>กด <kbd class="px-2 py-1 bg-gray-800 rounded shadow">F11</kbd> เพื่อเต็มจอ</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // เริ่มต้นแอปพลิเคชันเมื่อ DOM โหลดเสร็จ
        document.addEventListener('DOMContentLoaded', function() {
            // เก็บ reference ไปยัง element สำคัญ
            const codeEditor = document.getElementById('code-editor');
            const previewFrame = document.getElementById('preview-frame');
            const screenFrame = document.getElementById('screen-frame');
            const lineNumbersContainer = document.getElementById('line-numbers-container');
            const themeToggle = document.getElementById('theme-toggle');
            const themeText = document.getElementById('theme-text');
            const liveToggle = document.getElementById('live-toggle');
            const liveText = document.getElementById('live-text');
            const liveIndicator = document.getElementById('live-indicator');
            const liveStatusText = document.getElementById('live-status-text');
            const runBtn = document.getElementById('run-btn');
            const quickRunBtn = document.getElementById('quick-run-btn');
            const resetBtn = document.getElementById('reset-btn');
            const downloadBtn = document.getElementById('download-btn');
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            const lastUpdateEl = document.getElementById('last-update');
            const resizer = document.querySelector('.resizer');
            const editorSection = document.querySelector('.editor-section');
            const previewSection = document.querySelector('.preview-section');
            const notification = document.getElementById('notification');
            const notificationTitle = document.getElementById('notification-title');
            const notificationText = document.getElementById('notification-text');
            const notificationContent = document.getElementById('notification-content');
            const downloadModal = document.getElementById('download-modal');
            const filenameInput = document.getElementById('filename');
            const fileExtensionText = document.getElementById('file-extension');
            const confirmDownloadBtn = document.getElementById('confirm-download');
            const cancelDownloadBtn = document.getElementById('cancel-download');
            const screenModal = document.getElementById('screen-modal');
            const screenSizeDisplay = document.getElementById('screen-size-display');
            const closeScreenModal = document.getElementById('close-screen-modal');
            const mobileScreenBtn = document.getElementById('mobile-screen');
            const tabletScreenBtn = document.getElementById('tablet-screen');
            const desktopScreenBtn = document.getElementById('desktop-screen');
            const fullScreenBtn = document.getElementById('full-screen');
            const languageSelectorBtn = document.getElementById('language-selector-btn');
            const languageDropdown = document.getElementById('language-dropdown');
            const currentLanguageEl = document.getElementById('current-language');
            const editorTitle = document.getElementById('editor-title');
            const previewHtmlBtn = document.getElementById('preview-html');
            const previewScreenBtn = document.getElementById('preview-screen');
            const previewConsoleBtn = document.getElementById('preview-console');
            const consoleOutputContent = document.getElementById('console-output-content');
            const executionResultContent = document.getElementById('execution-result-content');
            const executionTime = document.getElementById('execution-time');
            const statLanguage = document.getElementById('stat-language');
            const statLines = document.getElementById('stat-lines');
            const statSize = document.getElementById('stat-size');
            const statLastRun = document.getElementById('stat-last-run');
            const exampleBtn = document.getElementById('example-btn');
            const outputTabs = document.querySelectorAll('.output-tab');
            const outputContents = document.querySelectorAll('.output-content');
            const runResult = document.getElementById('run-result');
            const executionOutput = document.getElementById('execution-output');
            
            // ตัวแปรสถานะ
            let isLiveMode = true;
            let isDarkMode = true;
            let isResizing = false;
            let isFullscreen = false;
            let editorWidth = 50; // เปอร์เซ็นต์
            let currentLine = 1;
            let currentLanguage = 'html';
            let currentScreenSize = 'desktop';
            let isRunningCode = false;
            let runHistory = [];
            let codeMirrorEditor = null;
            
            // ตัวอย่างโค้ดสำหรับแต่ละภาษา
            const codeExamples = {
                html: `<!DOCTYPE html>
<html>
<head>
    <title>ตัวอย่าง HTML</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        h1 { 
            color: #fff; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .box { 
            background: rgba(255,255,255,0.9); 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 10px;
            color: #333;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #2563eb;
        }
    </style>
</head>
<body>
    <h1>สวัสดี Live Code Tester Pro!</h1>
    <div class="box">
        <p>นี่คือตัวอย่างโค้ด HTML พื้นฐาน</p>
        <button onclick="showMessage()">คลิกทดสอบ</button>
        <div id="message"></div>
    </div>
    <script>
        function showMessage() {
            document.getElementById('message').innerHTML = '<h3>ยินดีต้อนรับสู่ Live Code Tester!</h3><p>คุณสามารถทดสอบโค้ดได้ทันทีที่นี่</p>';
        }
        
        console.log("ระบบ HTML พร้อมใช้งาน!");
    <\/script>
</body>
</html>`,
                
                javascript: `// โปรแกรม JavaScript ตัวอย่าง
console.log("เริ่มโปรแกรม JavaScript");

// ข้อมูลนักเรียน
const students = [
    { name: "สมชาย", age: 18, grades: [85, 90, 78] },
    { name: "สมหญิง", age: 17, grades: [95, 92, 98] },
    { name: "สมหมาย", age: 19, grades: [65, 70, 68] }
];

// ฟังก์ชันคำนวณเกรดเฉลี่ย
function calculateAverage(grades) {
    return grades.reduce((sum, grade) => sum + grade, 0) / grades.length;
}

// แสดงข้อมูลนักเรียน
console.log("\\nข้อมูลนักเรียน:");
students.forEach(student => {
    const avg = calculateAverage(student.grades).toFixed(2);
    console.log(\`\${student.name} (อายุ \${student.age} ปี) - เกรดเฉลี่ย: \${avg}\`);
});

// ฟังก์ชัน Fibonacci
function fibonacci(n) {
    let a = 0, b = 1;
    const result = [];
    for (let i = 0; i < n; i++) {
        result.push(a);
        [a, b] = [b, a + b];
    }
    return result;
}

console.log("\\nลำดับ Fibonacci 10 ตัวแรก:");
console.log(fibonacci(10).join(', '));

// การทำงานกับ DOM (สำหรับแสดงผล)
document.body.innerHTML = '<div style="padding: 20px; font-family: Arial;">';
document.body.innerHTML += '<h1>ผลลัพธ์ JavaScript</h1>';
document.body.innerHTML += '<div style="background: #f0f0f0; padding: 15px; border-radius: 5px;">';
students.forEach(student => {
    const avg = calculateAverage(student.grades).toFixed(2);
    document.body.innerHTML += \`<p>\${student.name}: \${avg} คะแนน</p>\`;
});
document.body.innerHTML += '</div>';
document.body.innerHTML += '<p>ดูผลลัพธ์เพิ่มเติมใน Console (F12)</p>';
document.body.innerHTML += '</div>';

console.log("\\nสิ้นสุดโปรแกรม JavaScript");`,
                
                python: `# โปรแกรม Python ตัวอย่าง
print("=" * 50)
print("โปรแกรมภาษา Python ตัวอย่าง")
print("=" * 50)

# ข้อมูลนักเรียน
students = [
    {"name": "สมชาย", "age": 18, "grades": [85, 90, 78]},
    {"name": "สมหญิง", "age": 17, "grades": [95, 92, 98]},
    {"name": "สมหมาย", "age": 19, "grades": [65, 70, 68]}
]

# แสดงข้อมูลนักเรียน
print("\\nข้อมูลนักเรียน:")
for student in students:
    avg = sum(student["grades"]) / len(student["grades"])
    print(f"{student['name']} (อายุ {student['age']} ปี) - เกรดเฉลี่ย: {avg:.2f}")

# ฟังก์ชัน Fibonacci
def fibonacci(n):
    a, b = 0, 1
    result = []
    for _ in range(n):
        result.append(a)
        a, b = b, a + b
    return result

print("\\nลำดับ Fibonacci 10 ตัวแรก:")
print(fibonacci(10))

# ตรวจสอบจำนวนเฉพาะ
def is_prime(num):
    if num < 2:
        return False
    for i in range(2, int(num**0.5) + 1):
        if num % i == 0:
            return False
    return True

print("\\nจำนวนเฉพาะ 1-20:")
primes = [num for num in range(1, 21) if is_prime(num)]
print(primes)

print("\\nสิ้นสุดโปรแกรมตัวอย่าง")`,
                
                csharp: `using System;

namespace CodeTesterExample
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("==========================================");
            Console.WriteLine("โปรแกรมภาษา C# ตัวอย่าง");
            Console.WriteLine("==========================================");
            Console.WriteLine();
            
            // ข้อมูลนักเรียน
            string[] names = { "สมชาย", "สมหญิง", "สมหมาย" };
            int[] ages = { 18, 17, 19 };
            double[,] grades = { {85, 90, 78}, {95, 92, 98}, {65, 70, 68} };
            
            Console.WriteLine("ข้อมูลนักเรียน:");
            for (int i = 0; i < names.Length; i++)
            {
                double sum = 0;
                for (int j = 0; j < 3; j++)
                {
                    sum += grades[i, j];
                }
                double average = sum / 3;
                Console.WriteLine($"{names[i]} (อายุ {ages[i]} ปี) - เกรดเฉลี่ย: {average:F2}");
            }
            
            // Fibonacci
            Console.WriteLine("\\nลำดับ Fibonacci 10 ตัวแรก:");
            int a = 0, b = 1;
            for (int i = 0; i < 10; i++)
            {
                Console.Write($"{a} ");
                int temp = a;
                a = b;
                b = temp + b;
            }
            
            // DateTime
            Console.WriteLine("\\n\\nข้อมูลวันที่และเวลา:");
            DateTime now = DateTime.Now;
            Console.WriteLine($"วันที่ปัจจุบัน: {now:dd/MM/yyyy}");
            Console.WriteLine($"เวลาปัจจุบัน: {now:HH:mm:ss}");
            Console.WriteLine($"วันในสัปดาห์: {now:dddd}");
            
            Console.WriteLine("\\n==========================================");
            Console.WriteLine("สิ้นสุดโปรแกรมตัวอย่าง C#");
            Console.WriteLine("==========================================");
        }
    }
}`,
                
                cpp: `#include <iostream>
#include <string>
#include <vector>
#include <ctime>

using namespace std;

// ฟังก์ชันคำนวณค่าเฉลี่ย
double calculateAverage(vector<int> grades) {
    double sum = 0;
    for (int grade : grades) {
        sum += grade;
    }
    return sum / grades.size();
}

int main() {
    cout << "==========================================" << endl;
    cout << "โปรแกรมภาษา C++ ตัวอย่าง" << endl;
    cout << "==========================================" << endl;
    cout << endl;
    
    // ข้อมูลนักเรียน
    vector<string> names = {"สมชาย", "สมหญิง", "สมหมาย"};
    vector<int> ages = {18, 17, 19};
    vector<vector<int>> grades = {
        {85, 90, 78},
        {95, 92, 98},
        {65, 70, 68}
    };
    
    cout << "ข้อมูลนักเรียน:" << endl;
    for (int i = 0; i < names.size(); i++) {
        double average = calculateAverage(grades[i]);
        cout << names[i] << " (อายุ " << ages[i] << " ปี) - เกรดเฉลี่ย: " << average << endl;
    }
    
    // Fibonacci
    cout << "\\nลำดับ Fibonacci 10 ตัวแรก:" << endl;
    int a = 0, b = 1;
    for (int i = 0; i < 10; i++) {
        cout << a << " ";
        int temp = a;
        a = b;
        b = temp + b;
    }
    
    // วันที่และเวลา
    cout << "\\n\\nข้อมูลวันที่และเวลา:" << endl;
    time_t now = time(0);
    tm* ltm = localtime(&now);
    cout << "วันที่: " << ltm->tm_mday << "/" << 1 + ltm->tm_mon << "/" << 1900 + ltm->tm_year << endl;
    cout << "เวลา: " << ltm->tm_hour << ":" << ltm->tm_min << ":" << ltm->tm_sec << endl;
    
    cout << "\\n==========================================" << endl;
    cout << "สิ้นสุดโปรแกรมตัวอย่าง C++" << endl;
    cout << "==========================================" << endl;
    
    return 0;
}`,
                
                php: `<?php
// โปรแกรมภาษา PHP ตัวอย่าง
echo "==========================================\\n";
echo "โปรแกรมภาษา PHP ตัวอย่าง\\n";
echo "==========================================\\n\\n";

// ข้อมูลนักเรียน
$students = [
    ["name" => "สมชาย", "age" => 18, "grades" => [85, 90, 78]],
    ["name" => "สมหญิง", "age" => 17, "grades" => [95, 92, 98]],
    ["name" => "สมหมาย", "age" => 19, "grades" => [65, 70, 68]]
];

// แสดงข้อมูลนักเรียน
echo "ข้อมูลนักเรียน:\\n";
foreach ($students as $student) {
    $average = array_sum($student["grades"]) / count($student["grades"]);
    printf("%s (อายุ %d ปี) - เกรดเฉลี่ย: %.2f\\n", 
           $student["name"], $student["age"], $average);
}

// ฟังก์ชัน Fibonacci
function fibonacci($n) {
    $a = 0;
    $b = 1;
    $result = [];
    for ($i = 0; $i < $n; $i++) {
        $result[] = $a;
        $temp = $a;
        $a = $b;
        $b = $temp + $b;
    }
    return $result;
}

echo "\\nลำดับ Fibonacci 10 ตัวแรก:\\n";
echo implode(", ", fibonacci(10)) . "\\n";

// ตรวจสอบจำนวนเฉพาะ
function is_prime($num) {
    if ($num < 2) return false;
    for ($i = 2; $i <= sqrt($num); $i++) {
        if ($num % $i == 0) return false;
    }
    return true;
}

echo "\\nจำนวนเฉพาะ 1-20:\\n";
$primes = [];
for ($i = 1; $i <= 20; $i++) {
    if (is_prime($i)) {
        $primes[] = $i;
    }
}
echo implode(", ", $primes) . "\\n";

// วันที่และเวลา
echo "\\nข้อมูลวันที่และเวลา:\\n";
date_default_timezone_set('Asia/Bangkok');
echo "วันที่ปัจจุบัน: " . date("d/m/Y") . "\\n";
echo "เวลาปัจจุบัน: " . date("H:i:s") . "\\n";
echo "วันในสัปดาห์: " . date("l") . "\\n";

echo "\\n==========================================\\n";
echo "สิ้นสุดโปรแกรมตัวอย่าง PHP\\n";
echo "==========================================\\n";
?>`
            };
            
            // ขยายข้อมูลภาษา
            const languageInfo = {
                html: { 
                    name: "HTML", 
                    extension: ".html", 
                    icon: "fab fa-html5", 
                    color: "text-orange-500",
                    runner: "browser",
                    mode: "htmlmixed"
                },
                javascript: { 
                    name: "JavaScript", 
                    extension: ".js", 
                    icon: "fab fa-js", 
                    color: "text-yellow-500",
                    runner: "browser",
                    mode: "javascript"
                },
                python: { 
                    name: "Python", 
                    extension: ".py", 
                    icon: "fab fa-python", 
                    color: "text-yellow-500",
                    runner: "skulpt",
                    mode: "python"
                },
                csharp: { 
                    name: "C#", 
                    extension: ".cs", 
                    icon: "fas fa-code", 
                    color: "text-purple-500",
                    runner: "console",
                    mode: "clike"
                },
                cpp: { 
                    name: "C++", 
                    extension: ".cpp", 
                    icon: "fas fa-cog", 
                    color: "text-blue-500",
                    runner: "console",
                    mode: "clike"
                },
                php: { 
                    name: "PHP", 
                    extension: ".php", 
                    icon: "fab fa-php", 
                    color: "text-indigo-500",
                    runner: "phpjs",
                    mode: "php"
                }
            };
            
            // ฟังก์ชันสำหรับแปลง HTML entities
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
            
            // ตั้งค่า CodeMirror Editor
            function setupCodeMirror() {
                const langInfo = languageInfo[currentLanguage];
                
                if (codeMirrorEditor) {
                    codeMirrorEditor.toTextArea();
                }
                
                codeMirrorEditor = CodeMirror.fromTextArea(document.getElementById('code-editor'), {
                    mode: langInfo.mode,
                    theme: "dracula",
                    lineNumbers: true,
                    lineWrapping: true,
                    indentUnit: 4,
                    tabSize: 4,
                    indentWithTabs: false,
                    electricChars: true,
                    autoCloseBrackets: true,
                    matchBrackets: true,
                    extraKeys: {
                        "Ctrl-Space": "autocomplete",
                        "Ctrl-S": function() {
                            saveCode();
                        },
                        "Ctrl-Enter": function() {
                            runCode();
                        },
                        "F11": function(cm) {
                            toggleFullscreen();
                        }
                    }
                });
                
                codeMirrorEditor.setSize("100%", "100%");
                
                // จัดการ events
                codeMirrorEditor.on("change", function() {
                    updateLineNumbers();
                    updateStats();
                    if (isLiveMode && currentLanguage === 'html') {
                        updatePreview();
                    }
                });
            }
            
            // โหลดโค้ดที่บันทึกไว้ (ถ้ามี)
            function loadSavedCode() {
                try {
                    const savedCode = localStorage.getItem(`codeTester_${currentLanguage}`);
                    if (savedCode) {
                        codeMirrorEditor.setValue(savedCode);
                        updatePreview();
                        updateLineNumbers();
                        updateStats();
                        showNotification('โหลดโค้ดสำเร็จ', `โหลดโค้ด ${languageInfo[currentLanguage].name} ที่บันทึกไว้`, 'success');
                    } else {
                        // ถ้าไม่มีโค้ดที่บันทึกไว้ ให้ใช้ตัวอย่างโค้ด
                        codeMirrorEditor.setValue(codeExamples[currentLanguage]);
                        updateLineNumbers();
                        updatePreview();
                        updateStats();
                    }
                } catch (e) {
                    console.error('Error loading saved code:', e);
                }
            }
            
            // บันทึกโค้ด
            function saveCode() {
                const code = codeMirrorEditor.getValue();
                localStorage.setItem(`codeTester_${currentLanguage}`, code);
                showNotification('บันทึกสำเร็จ', 'บันทึกโค้ดเรียบร้อยแล้ว', 'success');
            }
            
            // อัปเดต preview
            function updatePreview() {
                try {
                    const code = codeMirrorEditor.getValue();
                    
                    if (currentLanguage === 'html') {
                        // สร้าง iframe สำหรับแสดงผล HTML
                        const iframe = document.createElement('iframe');
                        iframe.className = 'web-output';
                        iframe.sandbox = 'allow-scripts allow-same-origin';
                        
                        executionOutput.innerHTML = '';
                        executionOutput.appendChild(iframe);
                        
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        iframeDoc.open();
                        iframeDoc.write(code);
                        iframeDoc.close();
                    } else if (currentLanguage === 'javascript') {
                        // รัน JavaScript ใน sandbox
                        runJavaScript(code);
                    }
                    
                    // อัปเดตเวลาล่าสุด
                    const now = new Date();
                    lastUpdateEl.textContent = now.toLocaleTimeString('th-TH');
                    
                    // บันทึกลง localStorage
                    localStorage.setItem(`codeTester_${currentLanguage}`, code);
                    
                    // อัปเดตสถิติ
                    updateStats();
                    
                    // แสดงการแจ้งเตือนถ้าไม่ได้อยู่ในโหมด live
                    if (!isLiveMode && currentLanguage === 'html') {
                        showNotification('อัปเดตสำเร็จ', 'อัปเดต preview เรียบร้อยแล้ว', 'success');
                    }
                } catch (e) {
                    console.error('Error updating preview:', e);
                    showNotification('เกิดข้อผิดพลาด', 'ไม่สามารถอัปเดต preview ได้', 'error');
                }
            }
            
            // รันโค้ด
            async function runCode() {
                if (isRunningCode) return;
                
                isRunningCode = true;
                const startTime = new Date();
                const code = codeMirrorEditor.getValue();
                
                // แสดงสถานะการรัน
                runBtn.innerHTML = '<div class="loading"></div> รันโค้ด...';
                runBtn.classList.remove('run-button-animation');
                
                try {
                    // เปลี่ยนไปที่แท็บ preview
                    switchTab('preview');
                    
                    // ล้างผลลัพธ์เก่า
                    consoleOutputContent.innerHTML = '';
                    
                    // เริ่มต้น console output
                    consoleOutputContent.innerHTML = `
                        <div class="console-line console-command">$ เริ่มรันโค้ดภาษา ${languageInfo[currentLanguage].name}</div>
                        <div class="console-line console-info">$ เวลาเริ่มต้น: ${startTime.toLocaleTimeString('th-TH')}</div>
                    `;
                    
                    // รันโค้ดตามภาษา
                    let result;
                    switch (currentLanguage) {
                        case 'html':
                            result = await runHTML(code);
                            break;
                        case 'javascript':
                            result = await runJavaScript(code);
                            break;
                        case 'python':
                            result = await runPython(code);
                            break;
                        case 'csharp':
                        case 'cpp':
                            result = await runConsoleLanguage(code, currentLanguage);
                            break;
                        case 'php':
                            result = await runPHP(code);
                            break;
                        default:
                            result = 'ภาษาไม่รองรับการรัน';
                    }
                    
                    const endTime = new Date();
                    const executionTimeMs = endTime - startTime;
                    
                    // แสดงผลลัพธ์ใน console
                    consoleOutputContent.innerHTML += `
                        <div class="console-line console-success">
                            $ การรันโค้ดสำเร็จเรียบร้อย! (${executionTimeMs}ms)
                        </div>
                    `;
                    
                    // อัปเดตเวลาการรัน
                    executionTime.textContent = `${executionTimeMs}ms`;
                    statLastRun.textContent = endTime.toLocaleTimeString('th-TH');
                    
                    // บันทึกประวัติการรัน
                    runHistory.push({
                        language: currentLanguage,
                        timestamp: endTime,
                        executionTime: executionTimeMs,
                        success: true
                    });
                    
                    // แสดงผลลัพธ์ใน preview
                    displayExecutionResult(result);
                    
                    showNotification('รันโค้ดสำเร็จ', `รันโค้ด ${languageInfo[currentLanguage].name} เสร็จสิ้นใน ${executionTimeMs}ms`, 'success');
                    
                } catch (error) {
                    console.error('Error running code:', error);
                    
                    // แสดงข้อผิดพลาดใน console
                    consoleOutputContent.innerHTML += `
                        <div class="console-line console-error">
                            $ เกิดข้อผิดพลาดในการรันโค้ด: ${error.message}
                        </div>
                        <div class="console-line console-warning">
                            $ โปรดตรวจสอบไวยากรณ์ของโค้ด
                        </div>
                    `;
                    
                    // แสดงข้อผิดพลาดใน preview
                    displayExecutionResult(`<div class="p-4 bg-red-100 text-red-800 rounded-lg">
                        <h3 class="font-bold">เกิดข้อผิดพลาด</h3>
                        <p>${escapeHtml(error.message)}</p>
                        <p class="mt-2 text-sm">โปรดตรวจสอบโค้ดของคุณอีกครั้ง</p>
                    </div>`);
                    
                    showNotification('เกิดข้อผิดพลาด', 'ไม่สามารถรันโค้ดได้', 'error');
                    
                } finally {
                    // คืนสถานะปุ่มรันโค้ด
                    isRunningCode = false;
                    runBtn.innerHTML = '<i class="fas fa-play-circle"></i> รันโค้ด';
                    runBtn.classList.add('run-button-animation');
                    
                    // อัปเดตสถิติ
                    updateStats();
                }
            }
            
            // แสดงผลลัพธ์การรัน
            function displayExecutionResult(content) {
                if (currentLanguage === 'html') {
                    // สำหรับ HTML ใช้ iframe
                    const iframe = document.createElement('iframe');
                    iframe.className = 'web-output';
                    iframe.sandbox = 'allow-scripts allow-same-origin';
                    
                    executionOutput.innerHTML = '';
                    executionOutput.appendChild(iframe);
                    
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    iframeDoc.open();
                    iframeDoc.write(codeMirrorEditor.getValue());
                    iframeDoc.close();
                } else {
                    // สำหรับภาษาอื่นๆ แสดงใน div
                    executionOutput.innerHTML = `
                        <div class="run-output">
                            <div class="output-area">${content}</div>
                        </div>
                    `;
                }
            }
            
            // รัน HTML
            async function runHTML(code) {
                return new Promise((resolve) => {
                    const iframe = document.createElement('iframe');
                    iframe.style.display = 'none';
                    iframe.sandbox = 'allow-scripts allow-same-origin';
                    
                    document.body.appendChild(iframe);
                    
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    iframeDoc.open();
                    iframeDoc.write(code);
                    iframeDoc.close();
                    
                    setTimeout(() => {
                        document.body.removeChild(iframe);
                        resolve('HTML รันสำเร็จ');
                    }, 100);
                });
            }
            
            // รัน JavaScript
            async function runJavaScript(code) {
                return new Promise((resolve) => {
                    try {
                        // สร้าง sandbox สำหรับรัน JavaScript
                        const sandbox = document.createElement('div');
                        sandbox.id = 'js-sandbox';
                        sandbox.style.display = 'none';
                        document.body.appendChild(sandbox);
                        
                        // บันทึก console.log ดั้งเดิม
                        const originalLog = console.log;
                        const originalError = console.error;
                        const originalWarn = console.warn;
                        
                        let output = '';
                        
                        // เปลี่ยน console.log เพื่อดักจับ output
                        console.log = function(...args) {
                            output += args.join(' ') + '\\n';
                            originalLog.apply(console, args);
                        };
                        
                        console.error = function(...args) {
                            output += '[ERROR] ' + args.join(' ') + '\\n';
                            originalError.apply(console, args);
                        };
                        
                        console.warn = function(...args) {
                            output += '[WARN] ' + args.join(' ') + '\\n';
                            originalWarn.apply(console, args);
                        };
                        
                        // รันโค้ด JavaScript
                        const script = document.createElement('script');
                        script.textContent = `
                            try {
                                ${code}
                            } catch (e) {
                                console.error('Runtime Error:', e.message);
                            }
                        `;
                        
                        sandbox.appendChild(script);
                        
                        // รีเซ็ต console functions
                        setTimeout(() => {
                            console.log = originalLog;
                            console.error = originalError;
                            console.warn = originalWarn;
                            
                            document.body.removeChild(sandbox);
                            
                            // แสดงผลลัพธ์
                            if (!output.trim()) {
                                output = 'JavaScript รันสำเร็จ (ไม่มี output)';
                            }
                            
                            // สร้าง UI สำหรับแสดงผล
                            const resultHTML = `
                                <div class="p-4 bg-blue-50 rounded-lg">
                                    <h3 class="font-bold text-lg mb-2">ผลลัพธ์ JavaScript</h3>
                                    <div class="bg-gray-900 text-white p-3 rounded font-mono text-sm overflow-auto max-h-60">
                                        ${escapeHtml(output)}
                                    </div>
                                    <p class="mt-2 text-sm text-gray-600">ดูรายละเอียดเพิ่มเติมในแท็บ Console</p>
                                </div>
                            `;
                            
                            displayExecutionResult(resultHTML);
                            resolve(output);
                        }, 100);
                        
                    } catch (e) {
                        throw new Error(`JavaScript Error: ${e.message}`);
                    }
                });
            }
            
            // รัน Python (ใช้ Skulpt)
            async function runPython(code) {
                return new Promise((resolve) => {
                    try {
                        // ตั้งค่า Skulpt
                        Sk.configure({
                            output: function(text) {
                                // อัปเดต output
                                consoleOutputContent.innerHTML += `<div class="console-line console-output-text">${escapeHtml(text)}</div>`;
                            },
                            read: function(x) {
                                if (Sk.builtinFiles === undefined || Sk.builtinFiles["files"][x] === undefined)
                                    throw "File not found: '" + x + "'";
                                return Sk.builtinFiles["files"][x];
                            }
                        });
                        
                        // รัน Python code
                        Sk.misceval.asyncToPromise(function() {
                            return Sk.importMainWithBody("<stdin>", false, code, true);
                        }).then(function() {
                            resolve('Python รันสำเร็จ');
                        }).catch(function(err) {
                            throw new Error(`Python Error: ${err.toString()}`);
                        });
                        
                    } catch (e) {
                        throw new Error(`Python Runtime Error: ${e.message}`);
                    }
                });
            }
            
            // รัน PHP (ใช้ PHP.js)
            async function runPHP(code) {
                return new Promise((resolve) => {
                    try {
                        // สำหรับ PHP จำลองการรัน (ในเบราว์เซอร์จริงต้องใช้ server-side)
                        let output = '';
                        
                        // จำลองผลลัพธ์ PHP เบื้องต้น
                        if (code.includes('echo') || code.includes('print')) {
                            // ดักจับ echo statements
                            const echoMatches = code.match(/echo\s+["']([^"']+)["']/g) || [];
                            const printMatches = code.match(/print\s+["']([^"']+)["']/g) || [];
                            
                            echoMatches.forEach(match => {
                                output += match.replace(/echo\s+["']/, '').replace(/["']/, '') + '\\n';
                            });
                            
                            printMatches.forEach(match => {
                                output += match.replace(/print\s+["']/, '').replace(/["']/, '') + '\\n';
                            });
                            
                            if (!output) {
                                output = 'PHP รันสำเร็จ (ไม่มี output จาก echo/print)';
                            }
                        } else {
                            output = 'PHP รันสำเร็จ';
                        }
                        
                        // แสดงผลลัพธ์
                        const resultHTML = `
                            <div class="p-4 bg-purple-50 rounded-lg">
                                <h3 class="font-bold text-lg mb-2">ผลลัพธ์ PHP (จำลอง)</h3>
                                <div class="bg-gray-900 text-white p-3 rounded font-mono text-sm overflow-auto max-h-60">
                                    ${escapeHtml(output)}
                                </div>
                                <p class="mt-2 text-sm text-gray-600">หมายเหตุ: PHP ต้องรันบนเซิร์ฟเวอร์จริง</p>
                            </div>
                        `;
                        
                        displayExecutionResult(resultHTML);
                        resolve(output);
                        
                    } catch (e) {
                        throw new Error(`PHP Error: ${e.message}`);
                    }
                });
            }
            
            // รันภาษา console (C#, C++)
            async function runConsoleLanguage(code, language) {
                return new Promise((resolve) => {
                    // จำลองการรันสำหรับ C# และ C++
                    let output = '';
                    
                    if (code.includes('Console.WriteLine') || code.includes('cout')) {
                        // ดักจับ output จาก C#/C++
                        const lines = code.split('\\n');
                        lines.forEach(line => {
                            if (line.includes('Console.WriteLine') || line.includes('cout')) {
                                const match = line.match(/Console\.WriteLine\(["']([^"']+)["']\)/) || 
                                             line.match(/cout\s*<<\s*["']([^"']+)["']/);
                                if (match && match[1]) {
                                    output += match[1] + '\\n';
                                }
                            }
                        });
                    }
                    
                    if (!output.trim()) {
                        output = `${languageInfo[language].name} รันสำเร็จ (ไม่มี output)`;
                    }
                    
                    // แสดงผลลัพธ์
                    const resultHTML = `
                        <div class="p-4 ${language === 'csharp' ? 'bg-purple-50' : 'bg-blue-50'} rounded-lg">
                            <h3 class="font-bold text-lg mb-2">ผลลัพธ์ ${languageInfo[language].name} (จำลอง)</h3>
                            <div class="bg-gray-900 text-white p-3 rounded font-mono text-sm overflow-auto max-h-60">
                                ${escapeHtml(output)}
                            </div>
                            <p class="mt-2 text-sm text-gray-600">หมายเหตุ: ${languageInfo[language].name} ต้องคอมไพล์บนเครื่องจริง</p>
                        </div>
                    `;
                    
                    displayExecutionResult(resultHTML);
                    resolve(output);
                });
            }
            
            // อัปเดตสถิติ
            function updateStats() {
                const code = codeMirrorEditor.getValue();
                const lines = code.split('\\n').length;
                const size = new Blob([code]).size;
                
                statLanguage.textContent = languageInfo[currentLanguage].name;
                statLines.textContent = lines;
                statSize.textContent = `${(size / 1024).toFixed(2)} KB`;
                
                if (runHistory.length > 0) {
                    const lastRun = runHistory[runHistory.length - 1];
                    statLastRun.textContent = lastRun.timestamp.toLocaleTimeString('th-TH');
                }
            }
            
            // เปลี่ยนภาษา
            function changeLanguage(lang) {
                if (lang === currentLanguage) return;
                
                // บันทึกโค้ดปัจจุบันก่อนเปลี่ยนภาษา
                const currentCode = codeMirrorEditor.getValue();
                localStorage.setItem(`codeTester_${currentLanguage}`, currentCode);
                
                // อัปเดตภาษาใหม่
                currentLanguage = lang;
                const langInfo = languageInfo[lang];
                
                // อัปเดต UI
                currentLanguageEl.textContent = langInfo.name;
                editorTitle.textContent = `${langInfo.name} Editor`;
                
                // อัปเดตไอคอนและสี
                languageSelectorBtn.innerHTML = `
                    <i class="${langInfo.icon} ${langInfo.color}"></i>
                    <span>${langInfo.name}</span>
                    <i class="fas fa-chevron-down ml-1"></i>
                `;
                
                // อัปเดตตัวเลือกใน dropdown
                document.querySelectorAll('.language-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.lang === lang) {
                        option.classList.add('active');
                    }
                });
                
                // ตั้งค่า CodeMirror ใหม่สำหรับภาษาใหม่
                setupCodeMirror();
                
                // โหลดโค้ดสำหรับภาษาใหม่
                loadSavedCode();
                
                // อัปเดตชื่อไฟล์ดาวน์โหลด
                filenameInput.value = `my-code${langInfo.extension}`;
                fileExtensionText.textContent = `ไฟล์จะถูกดาวน์โหลดเป็นไฟล์ ${langInfo.extension}`;
                
                // เปลี่ยนแท็บตามภาษา
                if (lang === 'html' || lang === 'javascript') {
                    switchTab('preview');
                } else {
                    switchTab('console');
                }
                
                showNotification('เปลี่ยนภาษา', `เปลี่ยนภาษาเป็น ${langInfo.name}`, 'success');
            }
            
            // เปลี่ยนแท็บ
            function switchTab(tabName) {
                // อัปเดตปุ่มแท็บ
                outputTabs.forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.dataset.tab === tabName) {
                        tab.classList.add('active');
                    }
                });
                
                // อัปเดตเนื้อหา
                outputContents.forEach(content => {
                    content.classList.remove('active');
                    if (content.id === `${tabName}-content`) {
                        content.classList.add('active');
                    }
                });
            }
            
            // แสดงหน้าจอใหญ่
            function showScreenModal() {
                screenModal.classList.add('show');
                
                // อัปเดตขนาดหน้าจอเริ่มต้น
                updateScreenSize('desktop');
            }
            
            // อัปเดตขนาดหน้าจอ
            function updateScreenSize(size) {
                currentScreenSize = size;
                
                // อัปเดตปุ่ม
                mobileScreenBtn.classList.remove('active');
                tabletScreenBtn.classList.remove('active');
                desktopScreenBtn.classList.remove('active');
                fullScreenBtn.classList.remove('active');
                
                // ตั้งค่าขนาด
                const screenBody = document.querySelector('.screen-modal-body');
                const screenFrame = document.getElementById('screen-frame');
                
                if (size === 'mobile') {
                    mobileScreenBtn.classList.add('active');
                    screenBody.style.maxWidth = '375px';
                    screenBody.style.margin = '0 auto';
                    screenFrame.style.width = '375px';
                    screenFrame.style.height = '667px';
                    screenSizeDisplay.textContent = 'ขนาด: มือถือ (375x667)';
                } else if (size === 'tablet') {
                    tabletScreenBtn.classList.add('active');
                    screenBody.style.maxWidth = '768px';
                    screenBody.style.margin = '0 auto';
                    screenFrame.style.width = '768px';
                    screenFrame.style.height = '1024px';
                    screenSizeDisplay.textContent = 'ขนาด: แท็บเล็ต (768x1024)';
                } else if (size === 'desktop') {
                    desktopScreenBtn.classList.add('active');
                    screenBody.style.maxWidth = '100%';
                    screenBody.style.margin = '0';
                    screenFrame.style.width = '100%';
                    screenFrame.style.height = '100%';
                    screenSizeDisplay.textContent = 'ขนาด: เดสก์ท็อป (100%)';
                } else if (size === 'full') {
                    fullScreenBtn.classList.add('active');
                    screenBody.style.maxWidth = '100%';
                    screenBody.style.margin = '0';
                    screenFrame.style.width = '100%';
                    screenFrame.style.height = '100%';
                    screenSizeDisplay.textContent = 'ขนาด: เต็มจอ';
                }
                
                // อัปเดต iframe สำหรับ HTML
                if (currentLanguage === 'html') {
                    try {
                        const code = codeMirrorEditor.getValue();
                        const screenDoc = screenFrame.contentDocument || screenFrame.contentWindow.document;
                        screenDoc.open();
                        screenDoc.write(code);
                        screenDoc.close();
                    } catch (e) {
                        console.error('Error updating screen frame:', e);
                    }
                }
            }
            
            // สลับโหมดธีม
            function toggleTheme() {
                const htmlElement = document.documentElement;
                isDarkMode = !isDarkMode;
                
                if (isDarkMode) {
                    htmlElement.classList.add('dark');
                    themeText.textContent = 'ดาร์ก';
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i><span>ดาร์ก</span>';
                    themeToggle.classList.remove('bg-gray-200', 'text-gray-800');
                    themeToggle.classList.add('bg-gray-800', 'text-white');
                    
                    // อัปเดต CodeMirror theme
                    if (codeMirrorEditor) {
                        codeMirrorEditor.setOption('theme', 'dracula');
                    }
                    
                    showNotification('เปลี่ยนธีม', 'เปลี่ยนเป็นธีมดาร์กโหมด', 'success');
                } else {
                    htmlElement.classList.remove('dark');
                    themeText.textContent = 'ไลต์';
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i><span>ไลต์</span>';
                    themeToggle.classList.remove('bg-gray-800', 'text-white');
                    themeToggle.classList.add('bg-gray-200', 'text-gray-800');
                    
                    // อัปเดต CodeMirror theme
                    if (codeMirrorEditor) {
                        codeMirrorEditor.setOption('theme', 'default');
                    }
                    
                    showNotification('เปลี่ยนธีม', 'เปลี่ยนเป็นธีมไลต์โหมด', 'success');
                }
                
                // บันทึกการตั้งค่า
                localStorage.setItem('codeTesterTheme', isDarkMode ? 'dark' : 'light');
            }
            
            // สลับโหมด live update
            function toggleLiveMode() {
                isLiveMode = !isLiveMode;
                
                if (isLiveMode) {
                    liveText.textContent = 'Live';
                    liveStatusText.textContent = 'อัปเดตแบบเรียลไทม์';
                    liveToggle.innerHTML = '<i class="fas fa-play"></i><span>Live</span>';
                    liveToggle.classList.remove('bg-gray-600');
                    liveToggle.classList.add('bg-green-600');
                    liveIndicator.classList.remove('bg-gray-800', 'text-gray-400');
                    liveIndicator.classList.add('bg-green-900', 'text-green-200');
                    showNotification('อัปเดตแบบเรียลไทม์', 'เปิดโหมดอัปเดตแบบเรียลไทม์แล้ว', 'success');
                } else {
                    liveText.textContent = 'Paused';
                    liveStatusText.textContent = 'หยุดอัปเดตชั่วคราว';
                    liveToggle.innerHTML = '<i class="fas fa-pause"></i><span>Paused</span>';
                    liveToggle.classList.remove('bg-green-600');
                    liveToggle.classList.add('bg-gray-600');
                    liveIndicator.classList.remove('bg-green-900', 'text-green-200');
                    liveIndicator.classList.add('bg-gray-800', 'text-gray-400');
                    showNotification('หยุดอัปเดตชั่วคราว', 'ปิดโหมดอัปเดตแบบเรียลไทม์แล้ว', 'warning');
                }
            }
            
            // สลับโหมดเต็มจอ
            function toggleFullscreen() {
                isFullscreen = !isFullscreen;
                
                if (isFullscreen) {
                    editorSection.classList.add('fullscreen');
                    fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i><span class="hidden md:inline">ย่อ</span>';
                    fullscreenBtn.classList.remove('bg-gray-700');
                    fullscreenBtn.classList.add('bg-yellow-600');
                    
                    // ซ่อน preview section
                    previewSection.style.display = 'none';
                    resizer.style.display = 'none';
                    
                    showNotification('โหมดเต็มจอ', 'เปิดโหมดเต็มจอแล้ว - กด ESC เพื่อออก', 'info');
                } else {
                    editorSection.classList.remove('fullscreen');
                    fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i><span class="hidden md:inline">เต็มจอ</span>';
                    fullscreenBtn.classList.remove('bg-yellow-600');
                    fullscreenBtn.classList.add('bg-gray-700');
                    
                    // แสดง preview section
                    previewSection.style.display = 'flex';
                    resizer.style.display = 'block';
                    
                    showNotification('โหมดปกติ', 'ปิดโหมดเต็มจอแล้ว', 'success');
                }
            }
            
            // รีเซ็ตโค้ดเป็นค่าเริ่มต้น
            function resetCode() {
                showCustomConfirm(
                    'รีเซ็ตโค้ด',
                    `คุณแน่ใจที่จะรีเซ็ตโค้ด ${languageInfo[currentLanguage].name} ทั้งหมด? การเปลี่ยนแปลงทั้งหมดจะหายไป`,
                    function() {
                        codeMirrorEditor.setValue(codeExamples[currentLanguage]);
                        updatePreview();
                        updateStats();
                        showNotification('รีเซ็ตสำเร็จ', `รีเซ็ตโค้ด ${languageInfo[currentLanguage].name} เป็นค่าเริ่มต้นแล้ว`, 'success');
                    }
                );
            }
            
            // แสดง modal ดาวน์โหลด
            function showDownloadModal() {
                downloadModal.classList.add('show');
                filenameInput.focus();
                filenameInput.select();
            }
            
            // ซ่อน modal ดาวน์โหลด
            function hideDownloadModal() {
                downloadModal.classList.remove('show');
            }
            
            // ดาวน์โหลดไฟล์โค้ด
            function downloadCode() {
                const content = codeMirrorEditor.getValue();
                const filename = filenameInput.value || `my-code${languageInfo[currentLanguage].extension}`;
                
                // สร้าง Blob จากเนื้อหา
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                
                // สร้าง element a สำหรับดาวน์โหลด
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                
                // ล้างทรัพยากร
                setTimeout(() => {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 100);
                
                hideDownloadModal();
                showNotification('ดาวน์โหลดสำเร็จ', `ดาวน์โหลดไฟล์ "${filename}" เรียบร้อยแล้ว`, 'success');
            }
            
            // แสดงการแจ้งเตือนแบบสวยงาม
            function showNotification(title, message, type = 'success') {
                // ตั้งค่าชื่อเรื่องและข้อความ
                notificationTitle.textContent = title;
                notificationText.textContent = message;
                
                // ตั้งค่าสีตามประเภท
                notificationContent.className = 'notification-content';
                if (type === 'success') {
                    notificationContent.classList.add('notification-success');
                } else if (type === 'error') {
                    notificationContent.classList.add('notification-error');
                } else if (type === 'warning') {
                    notificationContent.classList.add('notification-warning');
                } else if (type === 'info') {
                    notificationContent.classList.add('notification-info');
                }
                
                // แสดงการแจ้งเตือน
                notification.classList.add('show');
                
                // ซ่อนการแจ้งเตือนหลังจาก 4 วินาที
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 4000);
            }
            
            // แสดงการยืนยันแบบสวยงามแทน confirm
            function showCustomConfirm(title, message, onConfirm) {
                const confirmModal = document.createElement('div');
                confirmModal.className = 'modal show';
                confirmModal.innerHTML = `
                    <div class="modal-content">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-exclamation-triangle mr-2 text-yellow-500"></i> ${escapeHtml(title)}
                        </h3>
                        <div class="mb-6">
                            <p class="text-gray-300">${escapeHtml(message)}</p>
                        </div>
                        <div class="flex justify-end space-x-3">
                            <button id="custom-cancel" class="px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors">
                                ยกเลิก
                            </button>
                            <button id="custom-confirm" class="px-4 py-2 bg-red-600 rounded-lg hover:bg-red-700 transition-colors">
                                ตกลง
                            </button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(confirmModal);
                
                // จัดการเหตุการณ์
                document.getElementById('custom-cancel').addEventListener('click', function() {
                    document.body.removeChild(confirmModal);
                });
                
                document.getElementById('custom-confirm').addEventListener('click', function() {
                    document.body.removeChild(confirmModal);
                    onConfirm();
                });
                
                // ปิดเมื่อคลิกภายนอก
                confirmModal.addEventListener('click', function(e) {
                    if (e.target === confirmModal) {
                        document.body.removeChild(confirmModal);
                    }
                });
            }
            
            // ตั้งค่า resizer
            function setupResizer() {
                resizer.addEventListener('mousedown', function(e) {
                    isResizing = true;
                    resizer.classList.add('active');
                    document.body.style.cursor = 'col-resize';
                    e.preventDefault();
                });
                
                document.addEventListener('mousemove', function(e) {
                    if (!isResizing) return;
                    
                    const containerWidth = document.querySelector('.split-container').offsetWidth;
                    const mouseX = e.clientX;
                    const containerLeft = document.querySelector('.split-container').getBoundingClientRect().left;
                    
                    // คำนวณเปอร์เซ็นต์ความกว้าง
                    editorWidth = ((mouseX - containerLeft) / containerWidth) * 100;
                    
                    // จำกัดขนาดขั้นต่ำและสูงสุด
                    if (editorWidth < 20) editorWidth = 20;
                    if (editorWidth > 80) editorWidth = 80;
                    
                    // อัปเดตขนาด
                    editorSection.style.width = `${editorWidth}%`;
                    previewSection.style.width = `${100 - editorWidth}%`;
                });
                
                document.addEventListener('mouseup', function() {
                    if (isResizing) {
                        isResizing = false;
                        resizer.classList.remove('active');
                        document.body.style.cursor = '';
                        
                        // บันทึกขนาดที่ปรับ
                        localStorage.setItem('codeTesterEditorWidth', editorWidth);
                    }
                });
                
                // โหลดขนาดที่บันทึกไว้
                const savedWidth = localStorage.getItem('codeTesterEditorWidth');
                if (savedWidth) {
                    editorWidth = parseFloat(savedWidth);
                    editorSection.style.width = `${editorWidth}%`;
                    previewSection.style.width = `${100 - editorWidth}%`;
                }
            }
            
            // อัปเดต line numbers (สำหรับ textarea fallback)
            function updateLineNumbers() {
                const code = codeMirrorEditor.getValue();
                const lines = code.split('\n').length;
                const scrollInfo = codeMirrorEditor.getScrollInfo();
                
                // CodeMirror จัดการ line numbers ให้แล้ว
                // ฟังก์ชันนี้เก็บไว้สำหรับความเข้ากันได้
            }
            
            // ตั้งค่า keyboard shortcuts
            function setupKeyboardShortcuts() {
                document.addEventListener('keydown', function(e) {
                    // Ctrl+S เพื่อบันทึก
                    if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                        e.preventDefault();
                        saveCode();
                    }
                    
                    // Ctrl+Enter หรือ Ctrl+R เพื่อรันโค้ด
                    if ((e.ctrlKey || e.metaKey) && (e.key === 'Enter' || e.key === 'r')) {
                        e.preventDefault();
                        runCode();
                    }
                    
                    // Ctrl+D เพื่อสลับธีม
                    if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
                        e.preventDefault();
                        toggleTheme();
                    }
                    
                    // Ctrl+L เพื่อสลับโหมด live
                    if ((e.ctrlKey || e.metaKey) && e.key === 'l') {
                        e.preventDefault();
                        toggleLiveMode();
                    }
                    
                    // Ctrl+E เพื่อสลับเต็มจอ
                    if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
                        e.preventDefault();
                        toggleFullscreen();
                    }
                    
                    // Ctrl+G เพื่อไปยังบรรทัด
                    if ((e.ctrlKey || e.metaKey) && e.key === 'g') {
                        e.preventDefault();
                        const line = prompt('ไปยังบรรทัดที่:');
                        if (line && !isNaN(line)) {
                            codeMirrorEditor.setCursor(parseInt(line) - 1, 0);
                            codeMirrorEditor.focus();
                        }
                    }
                    
                    // Ctrl+1-6 เพื่อเปลี่ยนภาษา
                    if ((e.ctrlKey || e.metaKey) && e.key >= '1' && e.key <= '6') {
                        e.preventDefault();
                        const langIndex = parseInt(e.key) - 1;
                        const langs = ['html', 'javascript', 'python', 'csharp', 'cpp', 'php'];
                        if (langs[langIndex]) {
                            changeLanguage(langs[langIndex]);
                        }
                    }
                    
                    // F11 สำหรับเต็มจอ
                    if (e.key === 'F11') {
                        e.preventDefault();
                        toggleFullscreen();
                    }
                    
                    // ESC เพื่อออกจากเต็มจอ
                    if (e.key === 'Escape' && isFullscreen) {
                        toggleFullscreen();
                    }
                    
                    // ESC เพื่อปิด modal
                    if (e.key === 'Escape') {
                        if (screenModal.classList.contains('show')) {
                            screenModal.classList.remove('show');
                        }
                        if (downloadModal.classList.contains('show')) {
                            hideDownloadModal();
                        }
                    }
                });
            }
            
            // ตั้งค่า event listeners
            function setupEventListeners() {
                // ปุ่มรันโค้ด
                runBtn.addEventListener('click', runCode);
                quickRunBtn.addEventListener('click', runCode);
                
                // ปุ่มสลับธีม
                themeToggle.addEventListener('click', toggleTheme);
                
                // ปุ่มสลับโหมด live
                liveToggle.addEventListener('click', toggleLiveMode);
                
                // ปุ่มเต็มจอ
                fullscreenBtn.addEventListener('click', toggleFullscreen);
                
                // ปุ่มรีเซ็ต
                resetBtn.addEventListener('click', resetCode);
                
                // ปุ่มดาวน์โหลด
                downloadBtn.addEventListener('click', showDownloadModal);
                
                // ปุ่มยืนยันดาวน์โหลด
                confirmDownloadBtn.addEventListener('click', downloadCode);
                
                // ปุ่มยกเลิกดาวน์โหลด
                cancelDownloadBtn.addEventListener('click', hideDownloadModal);
                
                // ปิด modal เมื่อคลิกภายนอก
                downloadModal.addEventListener('click', function(e) {
                    if (e.target === downloadModal) {
                        hideDownloadModal();
                    }
                });
                
                // ดาวน์โหลดเมื่อกด Enter ในช่องชื่อไฟล์
                filenameInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        downloadCode();
                    }
                });
                
                // Language selector
                languageSelectorBtn.addEventListener('click', function() {
                    languageDropdown.classList.toggle('show');
                });
                
                // เลือกภาษา
                document.querySelectorAll('.language-option').forEach(option => {
                    option.addEventListener('click', function() {
                        const lang = this.dataset.lang;
                        changeLanguage(lang);
                        languageDropdown.classList.remove('show');
                    });
                });
                
                // ปิด language dropdown เมื่อคลิกภายนอก
                document.addEventListener('click', function(e) {
                    if (!languageSelectorBtn.contains(e.target) && !languageDropdown.contains(e.target)) {
                        languageDropdown.classList.remove('show');
                    }
                });
                
                // ตัวอย่างโค้ด
                exampleBtn.addEventListener('click', function() {
                    codeMirrorEditor.setValue(codeExamples[currentLanguage]);
                    updatePreview();
                    updateStats();
                    showNotification('โหลดตัวอย่าง', `โหลดตัวอย่างโค้ด ${languageInfo[currentLanguage].name}`, 'success');
                });
                
                // Output tabs
                outputTabs.forEach(tab => {
                    tab.addEventListener('click', function() {
                        const tabName = this.dataset.tab;
                        switchTab(tabName);
                    });
                });
                
                // Preview mode buttons
                previewHtmlBtn.addEventListener('click', function() {
                    switchTab('preview');
                });
                
                previewConsoleBtn.addEventListener('click', function() {
                    switchTab('console');
                });
                
                previewScreenBtn.addEventListener('click', function() {
                    showScreenModal();
                });
                
                // Screen modal
                closeScreenModal.addEventListener('click', function() {
                    screenModal.classList.remove('show');
                });
                
                mobileScreenBtn.addEventListener('click', function() {
                    updateScreenSize('mobile');
                });
                
                tabletScreenBtn.addEventListener('click', function() {
                    updateScreenSize('tablet');
                });
                
                desktopScreenBtn.addEventListener('click', function() {
                    updateScreenSize('desktop');
                });
                
                fullScreenBtn.addEventListener('click', function() {
                    updateScreenSize('full');
                });
                
                // ปิด screen modal เมื่อคลิกภายนอก
                screenModal.addEventListener('click', function(e) {
                    if (e.target === screenModal) {
                        screenModal.classList.remove('show');
                    }
                });
            }
            
            // โหลดการตั้งค่าธีมที่บันทึกไว้
            function loadTheme() {
                const savedTheme = localStorage.getItem('codeTesterTheme');
                if (savedTheme === 'light') {
                    isDarkMode = false;
                    toggleTheme(); // เรียกเพื่อสลับไปยัง light mode
                }
            }
            
            // เริ่มต้นแอปพลิเคชัน
            function initApp() {
                // โหลดธีมที่บันทึกไว้
                loadTheme();
                
                // ตั้งค่า CodeMirror
                setupCodeMirror();
                
                // ตั้งค่า event listeners
                setupEventListeners();
                
                // ตั้งค่า resizer
                setupResizer();
                
                // ตั้งค่า keyboard shortcuts
                setupKeyboardShortcuts();
                
                // โหลดโค้ดเริ่มต้น
                loadSavedCode();
                
                // อัปเดตสถิติครั้งแรก
                updateStats();
                
                // แสดงการต้อนรับ
                setTimeout(() => {
                    showNotification('ยินดีต้อนรับ', 'Live Code Tester Pro พร้อมใช้งานแล้ว!', 'success');
                }, 1000);
            }
            
            // เรียกใช้ฟังก์ชันเริ่มต้น
            initApp();
        });
    </script>
</body>
</html>
